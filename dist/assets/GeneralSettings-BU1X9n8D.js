import{_ as R,p as G,u as T,r as v,l as Y,o as q,X as O,c as u,b as c,d as t,U as k,f as w,K as W,w as g,v as h,e as X,t as x,F as J,g as Q,a5 as Z,a as ee}from"./index-z4YXot-9.js";const te={class:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex flex-col items-center p-4 sm:p-6 lg:p-8"},se={class:"w-full max-w-7xl mx-auto mt-2 mb-4 flex items-center justify-between bg-white/90 rounded-lg shadow-lg py-2 px-5 transition-all duration-500 border border-gray-200"},ae={class:"flex items-center gap-2 text-base font-medium text-gray-600"},oe={class:"w-full max-w-6xl mx-auto"},le={class:"bg-white rounded-xl shadow-lg overflow-hidden"},re={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},ne={class:"space-y-6"},ie={class:"border-b border-gray-200 pb-6"},de={class:"space-y-4"},ue={class:"flex flex-col w-full"},ce={class:"relative"},fe={class:"flex flex-col w-full"},ve={class:"relative"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ge={class:"flex flex-col w-full"},me={class:"relative"},he={class:"flex flex-col w-full"},xe={class:"relative"},be={class:"flex"},ye={class:"relative"},we=["src","alt"],_e={key:1,class:"w-6 h-4 bg-gray-300 rounded flex items-center justify-center"},ke={class:"text-xs text-gray-600"},Ce={class:"text-sm"},Se={key:0,class:"absolute top-full left-0 mt-1 w-72 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto"},Ne={class:"p-2"},Ae={class:"max-h-48 overflow-y-auto"},Ee=["onClick"],je=["src","alt"],Pe={key:1,class:"w-6 h-4 bg-gray-300 rounded flex items-center justify-center"},De={class:"text-xs text-gray-600"},Me={class:"flex-1"},Ue={class:"text-sm font-medium text-gray-900"},Fe={class:"text-xs text-gray-500"},Be={class:"flex-1 relative"},Ke=["placeholder","maxlength"],Ve={class:"space-y-6"},ze={class:"bg-blue-50 rounded-lg p-6"},Le={class:"space-y-4"},Ie={class:"flex items-center justify-between"},$e={class:"ml-4"},He={class:"relative inline-flex items-center cursor-pointer"},Re={class:"flex flex-row gap-3 justify-end pt-8 border-t border-gray-200 mt-8"},Ge=["disabled"],Te={key:0,class:"flex items-center gap-2"},Ye={key:1,class:"flex items-center gap-2"},qe={__name:"GeneralSettings",setup(Oe){const b=ee;G();const f=T(),y=v(!1),r=v({schoolName:"",address:"",email:"",phone:"",academicYear:"",timezone:"UTC",language:"en",currency:"USD",dateFormat:"MM/DD/YYYY",twoFactorAuth:!1}),m=v(!1),p=v(""),i=v(""),n=v([]),l=v(null),M=Y(()=>p.value?n.value.filter(a=>a.country_name.toLowerCase().includes(p.value.toLowerCase())||a.country_code.includes(p.value)):n.value),U=a=>{if(l.value=a,m.value=!1,p.value="",i.value){const e=_(a.country_iso);let s=i.value.replace(/\D/g,"");s.length>e&&(i.value=s.substring(0,e))}C()},F=()=>{if(!l.value)return;const a=_(l.value.country_iso);let e=i.value.replace(/\D/g,"");e.length>a&&(e=e.substring(0,a),i.value=e),C()},C=()=>{if(!l.value)return;const a=i.value.replace(/\D/g,""),e=l.value.country_code||l.value.code||"+92";r.value.phone=a?`${e} ${a}`:""},B=a=>{if(!a||!n.value.length)return;const e=n.value.find(s=>{const d=s.country_code||s.code;return d&&a.startsWith(d)});if(e){l.value=e;const s=e.country_code||e.code;i.value=a.replace(s,"").trim()}else{const s=n.value.find(d=>d.country_iso==="PK")||n.value[0];s&&(l.value=s),i.value=a}},K=async()=>{try{const a=await b.get("/country-codes");if(a.data.success){n.value=a.data.data.map(s=>({...s,name:s.country_name||s.name,code:s.country_code||s.code,flag:s.flag_url||s.flag,placeholder:V(s.country_iso)}));const e=n.value.find(s=>s.country_iso==="PK")||n.value[0];e&&!l.value&&(l.value=e)}}catch(a){console.error("Error fetching countries:",a),n.value=[{country_name:"Pakistan",country_code:"+92",country_iso:"PK",flag_url:"https://flagcdn.com/w40/pk.png",name:"Pakistan",code:"+92",flag:"https://flagcdn.com/w40/pk.png",placeholder:"300 1234567"}],l.value=n.value[0]}},V=a=>({PK:"300 1234567",US:"(555) 123-4567",CA:"(555) 123-4567",GB:"20 7123 4567",IN:"98765 43210",SA:"50 123 4567",AE:"50 123 4567",AU:"400 123 456",DE:"030 12345678",BD:"1712 345678",NP:"984 1234567",CN:"138 0013 8000",AF:"70 123 4567",ID:"812 3456 789",PH:"917 123 4567"})[a]||"123 456 789",_=a=>({PK:10,US:10,CA:10,GB:11,IN:10,SA:9,AE:9,AU:9,DE:11,BD:11,NP:10,CN:11,AF:9,ID:10,PH:10})[a]||15,S=a=>{a.target.closest(".relative")||(m.value=!1)},z=()=>r.value.schoolName.trim()?r.value.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.value.email)?!0:(f.error("Please enter a valid email address"),!1):(f.error("Contact email is required"),!1):(f.error("School name is required"),!1),L=async()=>{var a,e;if(z()){y.value=!0;try{const s=await b.post("/settings/general",r.value);if(s.data.success||s.data.status){const d=s.data.action||"saved";d==="created"?f.success("ðŸŽ‰ School profile created successfully!"):d==="updated"?f.success("âœ… School settings updated successfully!"):f.success("Settings saved successfully!"),window.dispatchEvent(new CustomEvent("schoolSettingsUpdated"))}else f.error(s.data.message||"Failed to save settings")}catch(s){console.error("Error saving settings:",s),f.error(((e=(a=s.response)==null?void 0:a.data)==null?void 0:e.message)||"An error occurred while saving settings")}finally{y.value=!1}}},I=()=>{confirm("Are you sure you want to reset all settings to default values?")&&(r.value={schoolName:"",address:"",email:"",phone:"",timezone:"Asia/Karachi",language:"en",currency:"PKR"},f.info("Settings reset to default values"))},$=async()=>{try{const a=await b.get("/settings/check-school");return a.data.success?a.data.exists:!1}catch(a){return console.error("Error checking school exists:",a),!1}},H=async()=>{try{if(await $()){const e=await b.get("/settings/general");if(e.data.success||e.data.status){const s=e.data.data||e.data.result;s&&(r.value={schoolName:s.schoolName||"",address:s.address||"",email:s.email||"",phone:s.phone||"",timezone:s.timezone||"Asia/Karachi",language:s.language||"en",currency:s.currency||"PKR"},s.phone&&B(s.phone))}}else r.value={schoolName:"",address:"",email:"",phone:"",timezone:"Asia/Karachi",language:"en",currency:"PKR"}}catch(a){console.error("Error loading settings:",a)}};return q(async()=>{await K(),await H(),document.addEventListener("click",S)}),O(()=>{document.removeEventListener("click",S)}),(a,e)=>{var s,d,N,A,E,j,P,D;return c(),u("div",te,[t("div",se,[e[12]||(e[12]=t("h2",{class:"text-base font-medium text-gray-900 tracking-tight flex items-center gap-2"},[t("div",{class:"w-2 h-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full animate-pulse"}),w(" General Settings ")],-1)),t("nav",ae,[t("span",{class:"hover:text-purple-600 cursor-pointer transition-colors duration-200",onClick:e[0]||(e[0]=o=>a.$router.push("/dashboard"))},"Dashboard"),e[9]||(e[9]=t("span",{class:"mx-2"},"|",-1)),t("span",{class:"hover:text-purple-600 cursor-pointer transition-colors duration-200",onClick:e[1]||(e[1]=o=>a.$router.push("/settings"))},"Settings"),e[10]||(e[10]=t("span",{class:"mx-2"},"|",-1)),e[11]||(e[11]=t("span",{class:"text-gray-900 font-bold"},"General",-1))])]),e[29]||(e[29]=k('<div class="w-full max-w-6xl mx-auto mb-6" data-v-ba33af35><div class="flex flex-col items-center text-center" data-v-ba33af35><div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mb-4 shadow-lg" data-v-ba33af35><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-ba33af35><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" data-v-ba33af35></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" data-v-ba33af35></path></svg></div><h3 class="text-2xl font-bold text-gray-900 mb-2" data-v-ba33af35>School Configuration</h3><p class="text-gray-600 max-w-md" data-v-ba33af35>Configure your institution&#39;s basic information and system preferences.</p></div></div>',1)),t("div",oe,[t("div",le,[t("form",{onSubmit:W(L,["prevent"]),class:"p-6 sm:p-8"},[t("div",re,[t("div",ne,[t("div",ie,[e[22]||(e[22]=k('<div class="flex items-center gap-3 mb-4" data-v-ba33af35><div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center" data-v-ba33af35><svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-ba33af35><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h4M9 7h6m-6 4h6m-6 4h6" data-v-ba33af35></path></svg></div><h4 class="text-lg font-semibold text-gray-900" data-v-ba33af35>Institution Information</h4></div>',1)),t("div",de,[t("div",ue,[e[14]||(e[14]=t("label",{class:"mb-2 text-sm font-semibold text-gray-600 uppercase tracking-wider"},"School Name *",-1)),t("div",ce,[g(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.value.schoolName=o),type:"text",placeholder:"Enter your school name",required:"",class:"h-12 border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full"},null,512),[[h,r.value.schoolName]]),e[13]||(e[13]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",fe,[e[16]||(e[16]=t("label",{class:"mb-2 text-sm font-semibold text-gray-600 uppercase tracking-wider"},"School Address",-1)),t("div",ve,[g(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>r.value.address=o),placeholder:"Enter complete school address",rows:"3",class:"border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full resize-none"},null,512),[[h,r.value.address]]),e[15]||(e[15]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",pe,[t("div",ge,[e[18]||(e[18]=t("label",{class:"mb-2 text-sm font-semibold text-gray-600 uppercase tracking-wider"},"Contact Email *",-1)),t("div",me,[g(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.value.email=o),type:"email",placeholder:"admin@school.edu",required:"",class:"h-12 border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full"},null,512),[[h,r.value.email]]),e[17]||(e[17]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",he,[e[21]||(e[21]=t("label",{class:"mb-2 text-sm font-semibold text-gray-600 uppercase tracking-wider"},"Phone Number",-1)),t("div",xe,[t("div",be,[t("div",ye,[t("button",{onClick:e[5]||(e[5]=o=>m.value=!m.value),type:"button",class:"flex items-center gap-2 h-12 px-3 border-0 bg-transparent text-sm font-light text-gray-600 focus:ring-0 focus:outline-none"},[(s=l.value)!=null&&s.flag_url||(d=l.value)!=null&&d.flag?(c(),u("img",{key:0,src:l.value.flag_url||l.value.flag,alt:((N=l.value)==null?void 0:N.country_name)||((A=l.value)==null?void 0:A.name),class:"w-6 h-4 rounded object-cover"},null,8,we)):(c(),u("div",_e,[t("span",ke,x(((E=l.value)==null?void 0:E.country_iso)||"PK"),1)])),t("span",Ce,x(((j=l.value)==null?void 0:j.country_code)||((P=l.value)==null?void 0:P.code)||"+92"),1),e[19]||(e[19]=t("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor","stroke-width":"1.5",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})],-1))]),m.value?(c(),u("div",Se,[t("div",Ne,[g(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>p.value=o),type:"text",placeholder:"Search countries...",class:"w-full p-2 text-sm border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"},null,512),[[h,p.value]])]),t("div",Ae,[(c(!0),u(J,null,Q(M.value,o=>(c(),u("button",{key:o.country_code,onClick:We=>U(o),type:"button",class:"w-full flex items-center gap-3 p-3 text-left hover:bg-white transition-colors"},[o.flag_url||o.flag?(c(),u("img",{key:0,src:o.flag_url||o.flag,alt:o.country_name||o.name,class:"w-6 h-4 rounded object-cover"},null,8,je)):(c(),u("div",Pe,[t("span",De,x(o.country_iso),1)])),t("div",Me,[t("div",Ue,x(o.country_name||o.name),1),t("div",Fe,x(o.country_code||o.code),1)])],8,Ee))),128))])])):X("",!0)]),t("div",Be,[g(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>i.value=o),onInput:F,type:"tel",placeholder:((D=l.value)==null?void 0:D.placeholder)||"123 456 789",maxlength:l.value?_(l.value.country_iso):15,class:"h-12 border-0 bg-transparent px-3 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full"},null,40,Ke),[[h,i.value]])])]),e[20]||(e[20]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])])])])])]),t("div",Ve,[t("div",ze,[e[25]||(e[25]=k('<div class="flex items-center gap-3 mb-4" data-v-ba33af35><div class="w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center" data-v-ba33af35><svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-ba33af35><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" data-v-ba33af35></path></svg></div><h4 class="text-lg font-semibold text-gray-900" data-v-ba33af35>Security Settings</h4></div>',1)),t("div",Le,[t("div",Ie,[e[24]||(e[24]=t("div",{class:"flex-1"},[t("label",{class:"text-sm font-semibold text-gray-600"},"Enable Two-Factor Authentication"),t("p",{class:"text-xs text-gray-500 mt-1"},"Add an extra layer of security to your account")],-1)),t("div",$e,[t("label",He,[g(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>r.value.twoFactorAuth=o),type:"checkbox",class:"sr-only peer"},null,512),[[Z,r.value.twoFactorAuth]]),e[23]||(e[23]=t("div",{class:"w-11 h-6 bg-white peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-gray-200 after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-200 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"},null,-1))])])])])])])]),t("div",Re,[t("button",{type:"button",onClick:I,class:"h-10 w-24 rounded-full border-2 border-navy-300 text-sm font-bold text-gray-600 bg-white hover:bg-navy-50 hover:border-navy-400 hover:text-gray-900 transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-2"},e[26]||(e[26]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),w(" Reset ")])),t("button",{type:"submit",disabled:y.value,class:"h-10 w-24 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 text-sm font-bold text-white shadow hover:from-purple-600 hover:to-pink-600 transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[y.value?(c(),u("span",Te,e[27]||(e[27]=[t("div",{class:"w-4 h-4 border-2 border-gray-200 border-t-transparent rounded-full animate-spin"},null,-1),w(" Saving... ")]))):(c(),u("span",Ye,e[28]||(e[28]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),w(" Save ")])))],8,Ge)])],32)])])])}}},Je=R(qe,[["__scopeId","data-v-ba33af35"]]);export{Je as default};
