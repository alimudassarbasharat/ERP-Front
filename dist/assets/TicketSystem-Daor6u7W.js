import{_ as Y,I as Se,y as n,a as y,o as r,d as t,b as A,e as W,h as l,i as S,t as f,f as D,r as R,n as G,H as me,l as b,c as ve,J as K,A as L,K as le,B as O,C as re,F as H,z as N,p as ge,D as B,L as We,M as ze,w as X}from"./index-xvPUEXLW.js";import{L as Me,E as ce,C as Z,I as de,P as _e,U as he,T as be,Z as J,a as ye,F as Q,b as pe,c as ue,d as xe,e as Ue,f as De,g as fe,t as V,h as Fe,B as Ce,S as Pe}from"./ticketService-U9MSzEfy.js";import{c as w}from"./createLucideIcon-rObTRrQ3.js";import{C as ke}from"./clock-DJ4Hqvs8.js";import{S as Ve,X as Le,T as Ae}from"./x-4cOYDG3F.js";/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=w("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=w("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=w("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=w("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=w("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=w("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=w("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=w("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=w("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=w("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=w("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=w("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=w("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=w("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=w("ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=w("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),Ne={name:"TicketCard",components:{Hash:Ie,AlertCircle:ue,Clock:ke,CheckCircle2:pe,XCircle:we,Flag:Q,AlertTriangle:ye,Zap:J,Tag:be,User:he,MessageSquare:Ee,Paperclip:_e,Inbox:de,Circle:Z,Eye:ce,ListChecks:Me},props:{ticket:{type:Object,required:!0}},computed:{completedSubtasks(){return this.ticket.subtasks?this.ticket.subtasks.filter(d=>d.completed).length:0},subtaskProgress(){return!this.ticket.subtasks||this.ticket.subtasks.length===0?0:Math.round(this.completedSubtasks/this.ticket.subtasks.length*100)}},methods:{getStatusIcon(d){return{backlog:de,todo:Z,"in-progress":ke,review:ce,complete:pe}[d]||Z},getPriorityIcon(d){return{low:Q,medium:ue,high:ye,urgent:J}[d]||Q},formatStatus(d){return d.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},formatPriority(d){return d.charAt(0).toUpperCase()+d.slice(1)},truncateText(d,e){return d.length>e?d.substring(0,e)+"...":d},formatTime(d){if(!d)return"";try{return Se(new Date(d),{addSuffix:!0})}catch{return""}}}},je={class:"card-header"},Re={class:"ticket-id"},Oe={class:"ticket-title"},Je={class:"ticket-description"},Xe={class:"ticket-meta"},Ge={class:"meta-item"},Ze={class:"meta-item"},Qe={key:0,class:"subtasks-progress"},Ke={class:"subtasks-header"},Ye={class:"subtasks-count"},$e={class:"progress-bar"},et={class:"card-footer"},tt={class:"assignee-info"},st={class:"avatar"},ot={class:"assignee-name"},at={class:"ticket-stats"},it={key:0,class:"stat-item"},nt={key:1,class:"stat-item"},lt={key:2,class:"stat-item time"};function rt(d,e,i,s,p,u){const T=n("Hash"),k=n("Tag"),C=n("ListChecks"),_=n("User"),m=n("MessageSquare"),h=n("Paperclip"),z=n("Clock");return r(),y("div",{class:W(["ticket-card",`priority-${i.ticket.priority}`])},[t("div",{class:W(["priority-bar",`priority-${i.ticket.priority}`])},null,2),t("div",je,[t("div",Re,[l(T,{size:14}),S(" "+f(i.ticket.id),1)]),t("div",{class:W(["ticket-status",`status-${i.ticket.status}`])},[(r(),D(R(u.getStatusIcon(i.ticket.status)),{size:14})),S(" "+f(u.formatStatus(i.ticket.status)),1)],2)]),t("h3",Oe,f(i.ticket.title),1),t("p",Je,f(u.truncateText(i.ticket.description,100)),1),t("div",Xe,[t("div",Ge,[(r(),D(R(u.getPriorityIcon(i.ticket.priority)),{size:14,class:W(`priority-${i.ticket.priority}`)},null,8,["class"])),t("span",null,f(u.formatPriority(i.ticket.priority)),1)]),t("div",Ze,[l(k,{size:14}),t("span",null,f(i.ticket.category),1)])]),i.ticket.subtasks&&i.ticket.subtasks.length>0?(r(),y("div",Qe,[t("div",Ke,[l(C,{size:14}),e[0]||(e[0]=t("span",null,"Subtasks",-1)),t("span",Ye,f(u.completedSubtasks)+"/"+f(i.ticket.subtasks.length),1)]),t("div",$e,[t("div",{class:"progress-fill",style:G({width:u.subtaskProgress+"%"})},null,4)])])):A("",!0),t("div",et,[t("div",tt,[t("div",st,[l(_,{size:16})]),t("span",ot,f(i.ticket.assignee?i.ticket.assignee.name:"Unassigned"),1)]),t("div",at,[i.ticket.comments_count>0?(r(),y("div",it,[l(m,{size:14}),t("span",null,f(i.ticket.comments_count),1)])):A("",!0),i.ticket.attachments_count>0?(r(),y("div",nt,[l(h,{size:14}),t("span",null,f(i.ticket.attachments_count),1)])):A("",!0),i.ticket.updated_at?(r(),y("div",lt,[l(z,{size:14}),t("span",null,f(u.formatTime(i.ticket.updated_at)),1)])):A("",!0)])])],2)}const ct=Y(Ne,[["render",rt],["__scopeId","data-v-6b4a3fa0"]]),dt={name:"CreateTicketModal",components:{Plus:fe,X:Le,FileText:De,AlignLeft:qe,Flag:Q,Tag:be,User:he,Paperclip:_e,Upload:Ue,File:xe,Send:Ve},emits:["close","created"],setup(d,{emit:e}){const i=me(),s=b(!1),p=b({workspace_id:1,title:"",description:"",priority:"medium",category:"Technical",assignee_id:null,files:[]}),u=ve(()=>p.value.title.trim()!==""&&p.value.description.trim()!=="");return{form:p,submitting:s,isFormValid:u,handleFileUpload:_=>{const m=Array.from(_.target.files);p.value.files.push(...m)},removeFile:_=>{p.value.files.splice(_,1)},handleSubmit:async()=>{if(!(!u.value||s.value))try{s.value=!0;const _={workspace_id:p.value.workspace_id,title:p.value.title,description:p.value.description,priority:p.value.priority,category:p.value.category,assignee_id:p.value.assignee_id},m=await V.createTicket(_);if(m.success){if(p.value.files.length>0)for(const h of p.value.files)try{await V.uploadAttachment(m.data.id,h)}catch(z){console.error("Error uploading file:",z)}e("created",m.data),i.success("Ticket created successfully!")}}catch(_){console.error("Error creating ticket:",_),i.error("Failed to create ticket")}finally{s.value=!1}}}}},pt={class:"modal-container"},ut={class:"modal-header"},kt={class:"modal-title"},mt={class:"modal-body"},vt={class:"form-group"},ft={class:"form-label"},yt={class:"form-group"},gt={class:"form-label"},_t={class:"form-row"},ht={class:"form-group"},bt={class:"form-label"},Ct={class:"form-group"},wt={class:"form-label"},Tt={class:"form-group"},St={class:"form-label"},Wt={class:"form-group"},zt={class:"form-label"},Mt={class:"file-upload-area"},xt={for:"file-upload",class:"file-upload-label"},Ut={key:0,class:"uploaded-files"},Dt=["onClick"],Ft={class:"modal-footer"},Pt=["disabled"];function Vt(d,e,i,s,p,u){const T=n("Plus"),k=n("X"),C=n("FileText"),_=n("AlignLeft"),m=n("Flag"),h=n("Tag"),z=n("User"),F=n("Paperclip"),M=n("Upload"),x=n("File"),P=n("Send"),a=n("Clock");return r(),y("div",{class:"modal-overlay",onClick:e[9]||(e[9]=K(o=>d.$emit("close"),["self"]))},[t("div",pt,[t("div",ut,[t("h2",kt,[l(T,{size:24}),e[10]||(e[10]=S(" Create New Ticket ",-1))]),t("button",{onClick:e[0]||(e[0]=o=>d.$emit("close")),class:"btn-close"},[l(k,{size:20})])]),t("div",mt,[t("form",{onSubmit:e[8]||(e[8]=K((...o)=>s.handleSubmit&&s.handleSubmit(...o),["prevent"]))},[t("div",vt,[t("label",ft,[l(C,{size:16}),e[11]||(e[11]=S(" Title * ",-1))]),L(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.form.title=o),type:"text",class:"form-input",placeholder:"Enter ticket title...",required:""},null,512),[[le,s.form.title]])]),t("div",yt,[t("label",gt,[l(_,{size:16}),e[12]||(e[12]=S(" Description * ",-1))]),L(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.form.description=o),class:"form-textarea",rows:"5",placeholder:"Describe the issue in detail...",required:""},null,512),[[le,s.form.description]])]),t("div",_t,[t("div",ht,[t("label",bt,[l(m,{size:16}),e[13]||(e[13]=S(" Priority * ",-1))]),L(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.form.priority=o),class:"form-select",required:""},[...e[14]||(e[14]=[t("option",{value:"low"},"Low",-1),t("option",{value:"medium"},"Medium",-1),t("option",{value:"high"},"High",-1),t("option",{value:"urgent"},"Urgent",-1)])],512),[[O,s.form.priority]])]),t("div",Ct,[t("label",wt,[l(h,{size:16}),e[15]||(e[15]=S(" Category * ",-1))]),L(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.form.category=o),class:"form-select",required:""},[...e[16]||(e[16]=[re('<option value="Technical" data-v-16c7a5d1>Technical</option><option value="Payment" data-v-16c7a5d1>Payment</option><option value="Feature Request" data-v-16c7a5d1>Feature Request</option><option value="Bug" data-v-16c7a5d1>Bug</option><option value="Other" data-v-16c7a5d1>Other</option>',5)])],512),[[O,s.form.category]])])]),t("div",Tt,[t("label",St,[l(z,{size:16}),e[17]||(e[17]=S(" Assign To ",-1))]),L(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>s.form.assignee=o),class:"form-select"},[...e[18]||(e[18]=[re('<option value="" data-v-16c7a5d1>Select assignee...</option><option value="John Doe" data-v-16c7a5d1>John Doe</option><option value="Sarah Smith" data-v-16c7a5d1>Sarah Smith</option><option value="Mike Johnson" data-v-16c7a5d1>Mike Johnson</option><option value="Emily Davis" data-v-16c7a5d1>Emily Davis</option>',5)])],512),[[O,s.form.assignee]])]),t("div",Wt,[t("label",zt,[l(F,{size:16}),e[19]||(e[19]=S(" Attachments ",-1))]),t("div",Mt,[t("input",{type:"file",id:"file-upload",class:"file-input",multiple:"",onChange:e[6]||(e[6]=(...o)=>s.handleFileUpload&&s.handleFileUpload(...o))},null,32),t("label",xt,[l(M,{size:24}),e[20]||(e[20]=t("span",null,"Click to upload or drag and drop",-1)),e[21]||(e[21]=t("span",{class:"file-hint"},"PNG, JPG, PDF up to 10MB",-1))])]),s.form.files.length>0?(r(),y("div",Ut,[(r(!0),y(H,null,N(s.form.files,(o,I)=>(r(),y("div",{key:I,class:"file-item"},[l(x,{size:16}),t("span",null,f(o.name),1),t("button",{type:"button",onClick:j=>s.removeFile(I),class:"btn-remove-file"},[l(k,{size:14})],8,Dt)]))),128))])):A("",!0)]),t("div",Ft,[t("button",{type:"button",onClick:e[7]||(e[7]=o=>d.$emit("close")),class:"btn-cancel"}," Cancel "),t("button",{type:"submit",class:"btn-submit",disabled:!s.isFormValid||s.submitting},[s.submitting?(r(),D(a,{key:1,size:18,class:"animate-spin"})):(r(),D(P,{key:0,size:18})),S(" "+f(s.submitting?"Creating...":"Create Ticket"),1)],8,Pt)])],32)])])])}const Lt=Y(dt,[["render",Vt],["__scopeId","data-v-16c7a5d1"]]),At={name:"WorkspaceSidebar",components:{Briefcase:Ce,Plus:fe,Layers:Te,Edit2:Be,Trash2:Ae,Code:q,DollarSign:$,GraduationCap:ee,Users:ne,Settings:oe,Zap:J,Target:ie,Rocket:se,Heart:te,Star:ae,Check:Fe},props:{selectedWorkspace:{type:[String,Number],default:"all"}},emits:["update:selectedWorkspace","workspace-created","workspace-updated","workspace-deleted"],setup(d,{emit:e}){const i=me(),s=b(!0),p=b(!1),u=b(null),T=b([]),k=b({name:"",parent_id:null,icon:q,color:"linear-gradient(135deg, #8b5cf6, #7c3aed)",description:""}),C=[{name:"Code",component:q},{name:"DollarSign",component:$},{name:"GraduationCap",component:ee},{name:"Users",component:ne},{name:"Settings",component:oe},{name:"Zap",component:J},{name:"Target",component:ie},{name:"Rocket",component:se},{name:"Heart",component:te},{name:"Star",component:ae}],_=["linear-gradient(135deg, #3b82f6, #2563eb)","linear-gradient(135deg, #10b981, #059669)","linear-gradient(135deg, #8b5cf6, #7c3aed)","linear-gradient(135deg, #f59e0b, #d97706)","linear-gradient(135deg, #ef4444, #dc2626)","linear-gradient(135deg, #ec4899, #db2777)","linear-gradient(135deg, #06b6d4, #0891b2)","linear-gradient(135deg, #64748b, #475569)"],m=b({}),h=ve(()=>Object.values(m.value).reduce((c,g)=>c+g,0)),z=c=>m.value[c]||0,F=c=>{e("update:selectedWorkspace",c)},M=async()=>{try{s.value=!0;const c=await V.getWorkspaces();c.success&&(T.value=c.data.map(g=>({id:g.id,name:g.name,icon:P(g.icon),color:g.color,description:g.description})),await x())}catch(c){console.error("Error loading workspaces:",c),i.error("Failed to load workspaces")}finally{s.value=!1}},x=async()=>{try{if((await V.getStatistics()).success)for(const g of T.value)try{const U=await V.getWorkspaceStats(g.id);U.success&&(m.value[g.id]=U.data.total_tickets||0)}catch(U){console.error(`Error loading stats for workspace ${g.id}:`,U),m.value[g.id]=0}}catch(c){console.error("Error loading workspace stats:",c)}},P=c=>({Code:q,DollarSign:$,GraduationCap:ee,Users:ne,Settings:oe,Zap:J,Target:ie,Rocket:se,Heart:te,Star:ae})[c]||q,a=c=>{u.value=c,k.value={name:c.name,parent_id:null,icon:c.icon,color:c.color,description:c.description||""},p.value=!0},o=async c=>{try{await We.confirm(`Are you sure you want to delete "${c.name}"?`,"Delete Workspace",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning"}),await V.deleteWorkspace(c.id),await M(),e("workspace-deleted",c),i.success("Workspace deleted successfully")}catch(g){g!=="cancel"&&(console.error("Error deleting workspace:",g),i.error("Failed to delete workspace"))}},I=async()=>{var c;if(k.value.name.trim())try{const g=((c=C.find(v=>v.component===k.value.icon))==null?void 0:c.name)||"Code",U={name:k.value.name,icon:g,color:k.value.color,description:k.value.description,parent_id:k.value.parent_id};if(u.value)await V.updateWorkspace(u.value.id,U),i.success("Workspace updated successfully!"),e("workspace-updated",U);else{const v=await V.createWorkspace(U);v.success&&(i.success("Workspace created successfully!"),e("workspace-created",v.data))}await M(),j()}catch(g){console.error("Error saving workspace:",g),i.error("Failed to save workspace")}},j=()=>{p.value=!1,u.value=null,k.value={name:"",parent_id:null,icon:q,color:"linear-gradient(135deg, #8b5cf6, #7c3aed)",description:""}};return ge(()=>{M()}),{loading:s,workspaces:T,workspaceStats:m,showCreateModal:p,editingWorkspace:u,formData:k,availableIcons:C,availableColors:_,totalTickets:h,getWorkspaceTicketCount:z,selectWorkspace:F,editWorkspace:a,deleteWorkspace:o,saveWorkspace:I,closeModal:j,loadWorkspaces:M,loadWorkspaceStats:x}}},It={class:"workspace-sidebar"},Et={class:"sidebar-header"},Bt={class:"sidebar-title"},qt={class:"workspaces-list"},Ht={class:"workspace-icon-wrapper"},Nt={class:"workspace-icon",style:{background:"linear-gradient(135deg, #8b5cf6, #7c3aed)"}},jt={class:"workspace-info"},Rt={class:"workspace-count"},Ot=["onClick"],Jt={class:"workspace-icon-wrapper"},Xt={class:"workspace-info"},Gt={class:"workspace-name"},Zt={class:"workspace-count"},Qt={class:"workspace-actions"},Kt=["onClick"],Yt=["onClick"],$t={class:"workspace-form"},es={class:"form-group"},ts={class:"form-group"},ss={class:"workspace-option"},os={class:"form-group"},as={class:"icon-grid"},is=["onClick"],ns={class:"form-group"},ls={class:"color-grid"},rs=["onClick"],cs={class:"form-group"},ds={class:"dialog-footer"};function ps(d,e,i,s,p,u){const T=n("Briefcase"),k=n("Plus"),C=n("Layers"),_=n("Edit2"),m=n("Trash2"),h=n("el-input"),z=n("el-option"),F=n("el-select"),M=n("Check"),x=n("el-button"),P=n("el-dialog");return r(),y("div",It,[t("div",Et,[t("h3",Bt,[l(T,{size:18}),e[7]||(e[7]=S(" Workspaces ",-1))]),t("button",{onClick:e[0]||(e[0]=a=>s.showCreateModal=!0),class:"btn-add-workspace"},[l(k,{size:16})])]),t("div",qt,[t("div",{class:W(["workspace-item all",{active:i.selectedWorkspace==="all"}]),onClick:e[1]||(e[1]=a=>s.selectWorkspace("all"))},[t("div",Ht,[t("div",Nt,[l(C,{size:16})])]),t("div",jt,[e[8]||(e[8]=t("span",{class:"workspace-name"},"All Departments",-1)),t("span",Rt,f(s.totalTickets),1)])],2),e[10]||(e[10]=t("div",{class:"divider"},null,-1)),(r(!0),y(H,null,N(s.workspaces,a=>(r(),y("div",{key:a.id,class:W(["workspace-item",{active:i.selectedWorkspace===a.id}]),onClick:o=>s.selectWorkspace(a.id)},[t("div",Jt,[t("div",{class:"workspace-icon",style:G({background:a.color})},[(r(),D(R(a.icon),{size:16}))],4)]),t("div",Xt,[t("span",Gt,f(a.name),1),t("span",Zt,f(s.getWorkspaceTicketCount(a.id)),1)]),t("div",Qt,[t("button",{onClick:K(o=>s.editWorkspace(a),["stop"]),class:"action-btn"},[l(_,{size:14})],8,Kt),t("button",{onClick:K(o=>s.deleteWorkspace(a),["stop"]),class:"action-btn delete"},[l(m,{size:14})],8,Yt)])],10,Ot))),128)),t("button",{onClick:e[2]||(e[2]=a=>s.showCreateModal=!0),class:"create-workspace-btn"},[l(k,{size:16}),e[9]||(e[9]=t("span",null,"Create Workspace",-1))])]),l(P,{modelValue:s.showCreateModal,"onUpdate:modelValue":e[6]||(e[6]=a=>s.showCreateModal=a),title:s.editingWorkspace?"Edit Workspace":"Create New Workspace",width:"500px",class:"workspace-dialog"},{footer:B(()=>[t("div",ds,[l(x,{onClick:s.closeModal},{default:B(()=>[...e[16]||(e[16]=[S("Cancel",-1)])]),_:1},8,["onClick"]),l(x,{type:"primary",onClick:s.saveWorkspace,disabled:!s.formData.name.trim()},{default:B(()=>[S(f(s.editingWorkspace?"Update":"Create")+" Workspace ",1)]),_:1},8,["onClick","disabled"])])]),default:B(()=>[t("div",$t,[t("div",es,[e[11]||(e[11]=t("label",null,"Workspace Name *",-1)),l(h,{modelValue:s.formData.name,"onUpdate:modelValue":e[3]||(e[3]=a=>s.formData.name=a),placeholder:"e.g., Marketing Team",size:"large"},null,8,["modelValue"])]),t("div",ts,[e[12]||(e[12]=t("label",null,"Parent Workspace (Optional)",-1)),l(F,{modelValue:s.formData.parent_id,"onUpdate:modelValue":e[4]||(e[4]=a=>s.formData.parent_id=a),placeholder:"Select parent workspace",clearable:"",size:"large",class:"w-full"},{default:B(()=>[(r(!0),y(H,null,N(s.workspaces,a=>(r(),D(z,{key:a.id,label:a.name,value:a.id},{default:B(()=>[t("div",ss,[t("div",{class:"workspace-icon-mini",style:G({background:a.color})},[(r(),D(R(a.icon),{size:10}))],4),t("span",null,f(a.name),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),t("div",os,[e[13]||(e[13]=t("label",null,"Choose Icon",-1)),t("div",as,[(r(!0),y(H,null,N(s.availableIcons,a=>(r(),y("div",{key:a.name,onClick:o=>s.formData.icon=a.component,class:W(["icon-option",{selected:s.formData.icon===a.component}])},[(r(),D(R(a.component),{size:20}))],10,is))),128))])]),t("div",ns,[e[14]||(e[14]=t("label",null,"Choose Color",-1)),t("div",ls,[(r(!0),y(H,null,N(s.availableColors,a=>(r(),y("div",{key:a,onClick:o=>s.formData.color=a,class:W(["color-option",{selected:s.formData.color===a}]),style:G({background:a})},[s.formData.color===a?(r(),D(M,{key:0,size:16,class:"check-icon"})):A("",!0)],14,rs))),128))])]),t("div",cs,[e[15]||(e[15]=t("label",null,"Description (Optional)",-1)),l(h,{modelValue:s.formData.description,"onUpdate:modelValue":e[5]||(e[5]=a=>s.formData.description=a),type:"textarea",rows:3,placeholder:"Describe this workspace..."},null,8,["modelValue"])])])]),_:1},8,["modelValue","title"])])}const us=Y(At,[["render",ps],["__scopeId","data-v-fb0b6805"]]),ks={name:"TicketSystem",components:{Plus:fe,Search:Pe,AlertCircle:ue,Clock:ke,CheckCircle2:pe,XCircle:we,Layers:Te,Inbox:de,TicketIcon:He,Circle:Z,Eye:ce,Briefcase:Ce,TicketCard:ct,CreateTicketModal:Lt,WorkspaceSidebar:us},setup(){const d=ze(),e=me(),i=b(!0),s=b(!1),p=b(null),u=b([]),T=b(!1),k=b("all"),C=b("all"),_=b(""),m=b("all"),h=b("newest"),z=v=>u.value.filter(E=>E.status===v).length,F=v=>{k.value=v,o()},M=()=>{o()},x=v=>{o(),e.success("Workspace created successfully!")},P=v=>{o(),e.success("Workspace updated successfully!")},a=v=>{C.value===v.id&&(C.value="all"),o()},o=async()=>{try{s.value=!0;const v={workspace_id:C.value,status:k.value!=="all"?k.value:void 0,priority:m.value!=="all"?m.value:void 0,search:_.value||void 0,sort_by:h.value==="newest"||h.value==="oldest"?"created_at":h.value==="updated"?"updated_at":"priority",sort_order:h.value==="oldest"?"asc":"desc"},E=await V.getTickets(v);E.success&&(u.value=E.data.data||E.data)}catch(v){console.error("Error loading tickets:",v),e.error("Failed to load tickets")}finally{s.value=!1}},I=ve(()=>u.value),j=v=>{const E=v.id||v.ticket_number;d.push(`/tickets/${E}`)},c=v=>{T.value=!1,o(),e.success("Ticket created successfully")},g=v=>{o()};ge(async()=>{try{i.value=!0,await new Promise(v=>setTimeout(v,100)),p.value&&p.value.loadWorkspaces&&await p.value.loadWorkspaces(),await o()}catch(v){console.error("Error during initial load:",v),e.error("Failed to load ticket system")}finally{i.value=!1}}),X(C,()=>{o()}),X(m,()=>{o()}),X(h,()=>{o()});let U=null;return X(_,()=>{clearTimeout(U),U=setTimeout(()=>{o()},500)}),{tickets:u,initialLoading:i,loading:s,showCreateModal:T,activeFilter:k,selectedWorkspace:C,searchQuery:_,priorityFilter:m,sortBy:h,workspaceSidebarRef:p,filteredTickets:I,getStatusCount:z,filterTickets:F,filterByWorkspace:M,handleWorkspaceCreated:x,handleWorkspaceUpdated:P,handleWorkspaceDeleted:a,openTicketDetail:j,handleTicketCreated:c,handleTicketUpdate:g,loadTickets:o}}},ms={key:0,class:"loading-container"},vs={key:1,class:"ticket-system-layout"},fs={class:"workspace-sidebar-container"},ys={class:"ticket-main-content"},gs={class:"ticket-header"},_s={class:"header-left"},hs={class:"page-title"},bs={class:"header-right"},Cs={class:"filters-bar"},ws={class:"stats-chips"},Ts={class:"count"},Ss={class:"count"},Ws={class:"count"},zs={class:"count"},Ms={class:"count"},xs={class:"count"},Us={class:"filter-actions"},Ds={class:"search-box"},Fs={key:0,class:"tickets-loading"},Ps={key:1,class:"tickets-grid"},Vs={key:0,class:"empty-state"};function Ls(d,e,i,s,p,u){const T=n("WorkspaceSidebar"),k=n("TicketIcon"),C=n("Plus"),_=n("Layers"),m=n("Inbox"),h=n("Circle"),z=n("Clock"),F=n("Eye"),M=n("CheckCircle2"),x=n("Search"),P=n("TicketCard"),a=n("CreateTicketModal");return s.initialLoading?(r(),y("div",ms,[...e[12]||(e[12]=[t("div",{class:"custom-loader"},[t("div",{class:"loader-spinner"}),t("div",{class:"loader-text"},"Loading Ticket System..."),t("div",{class:"loader-subtext"},"Please wait while we fetch your workspaces and tickets")],-1)])])):(r(),y("div",vs,[t("div",fs,[l(T,{ref:"workspaceSidebarRef",selectedWorkspace:s.selectedWorkspace,"onUpdate:selectedWorkspace":e[0]||(e[0]=o=>s.selectedWorkspace=o),onWorkspaceCreated:s.handleWorkspaceCreated,onWorkspaceUpdated:s.handleWorkspaceUpdated,onWorkspaceDeleted:s.handleWorkspaceDeleted},null,8,["selectedWorkspace","onWorkspaceCreated","onWorkspaceUpdated","onWorkspaceDeleted"])]),t("div",ys,[t("div",gs,[t("div",_s,[t("h1",hs,[l(k,{size:28,class:"title-icon"}),e[13]||(e[13]=S(" Ticket System ",-1))]),e[14]||(e[14]=t("p",{class:"page-subtitle"},"Manage and track all support tickets",-1))]),t("div",bs,[t("button",{onClick:e[1]||(e[1]=o=>s.showCreateModal=!0),class:"btn-create-ticket"},[l(C,{size:20}),e[15]||(e[15]=S(" Create Ticket ",-1))])])]),t("div",Cs,[t("div",ws,[t("div",{class:W(["stat-chip",{active:s.activeFilter==="all"}]),onClick:e[2]||(e[2]=o=>s.filterTickets("all"))},[l(_,{size:16}),e[16]||(e[16]=t("span",null,"All",-1)),t("span",Ts,f(s.tickets.length),1)],2),t("div",{class:W(["stat-chip backlog",{active:s.activeFilter==="backlog"}]),onClick:e[3]||(e[3]=o=>s.filterTickets("backlog"))},[l(m,{size:16}),e[17]||(e[17]=t("span",null,"Backlog",-1)),t("span",Ss,f(s.getStatusCount("backlog")),1)],2),t("div",{class:W(["stat-chip todo",{active:s.activeFilter==="todo"}]),onClick:e[4]||(e[4]=o=>s.filterTickets("todo"))},[l(h,{size:16}),e[18]||(e[18]=t("span",null,"To Do",-1)),t("span",Ws,f(s.getStatusCount("todo")),1)],2),t("div",{class:W(["stat-chip progress",{active:s.activeFilter==="in-progress"}]),onClick:e[5]||(e[5]=o=>s.filterTickets("in-progress"))},[l(z,{size:16}),e[19]||(e[19]=t("span",null,"In Progress",-1)),t("span",zs,f(s.getStatusCount("in-progress")),1)],2),t("div",{class:W(["stat-chip review",{active:s.activeFilter==="review"}]),onClick:e[6]||(e[6]=o=>s.filterTickets("review"))},[l(F,{size:16}),e[20]||(e[20]=t("span",null,"Review",-1)),t("span",Ms,f(s.getStatusCount("review")),1)],2),t("div",{class:W(["stat-chip complete",{active:s.activeFilter==="complete"}]),onClick:e[7]||(e[7]=o=>s.filterTickets("complete"))},[l(M,{size:16}),e[21]||(e[21]=t("span",null,"Complete",-1)),t("span",xs,f(s.getStatusCount("complete")),1)],2)]),t("div",Us,[t("div",Ds,[l(x,{size:18,class:"search-icon"}),L(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>s.searchQuery=o),type:"text",placeholder:"Search tickets...",class:"search-input"},null,512),[[le,s.searchQuery]])]),L(t("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>s.priorityFilter=o),class:"filter-select"},[...e[22]||(e[22]=[re('<option value="all" data-v-83d7da26>All Priorities</option><option value="low" data-v-83d7da26>Low</option><option value="medium" data-v-83d7da26>Medium</option><option value="high" data-v-83d7da26>High</option><option value="urgent" data-v-83d7da26>Urgent</option>',5)])],512),[[O,s.priorityFilter]]),L(t("select",{"onUpdate:modelValue":e[10]||(e[10]=o=>s.sortBy=o),class:"filter-select"},[...e[23]||(e[23]=[t("option",{value:"newest"},"Newest First",-1),t("option",{value:"oldest"},"Oldest First",-1),t("option",{value:"priority"},"Priority",-1),t("option",{value:"updated"},"Recently Updated",-1)])],512),[[O,s.sortBy]])])]),s.loading?(r(),y("div",Fs,[...e[24]||(e[24]=[t("div",{class:"tickets-loader"},[t("div",{class:"loader-spinner-small"}),t("div",{class:"loader-text-small"},"Loading tickets...")],-1)])])):(r(),y("div",Ps,[(r(!0),y(H,null,N(s.filteredTickets,o=>(r(),D(P,{key:o.id,ticket:o,onClick:I=>s.openTicketDetail(o),onUpdate:s.handleTicketUpdate},null,8,["ticket","onClick","onUpdate"]))),128)),s.filteredTickets.length===0?(r(),y("div",Vs,[l(m,{size:64,class:"empty-icon"}),e[25]||(e[25]=t("h3",null,"No tickets found",-1)),e[26]||(e[26]=t("p",null,"Try adjusting your filters or create a new ticket",-1))])):A("",!0)])),s.showCreateModal?(r(),D(a,{key:2,onClose:e[11]||(e[11]=o=>s.showCreateModal=!1),onCreated:s.handleTicketCreated},null,8,["onCreated"])):A("",!0)])]))}const Hs=Y(ks,[["render",Ls],["__scopeId","data-v-83d7da26"]]);export{Hs as default};
