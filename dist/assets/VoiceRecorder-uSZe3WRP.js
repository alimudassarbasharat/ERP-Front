import{_ as z,l as i,c as b,a7 as B,y,a as m,o as p,b as R,h as g,d as f,t as q}from"./index-xvPUEXLW.js";import{T as E,S as N,X}from"./x-4cOYDG3F.js";import{c as h}from"./createLucideIcon-rObTRrQ3.js";/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=h("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]);/**
 * @license lucide-vue-next v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=h("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),L={name:"VoiceRecorder",components:{Mic:F,Square:U,X,Send:N,Trash2:E},emits:["recording-complete","recording-ready","recording-removed"],setup(w,{emit:a}){const c=i(!1),e=i(null),t=i(null),d=i([]),u=i(null),s=i(0),n=i(null),o=i(0),_=b(()=>e.value!==null),k=b(()=>{const r=Math.floor(s.value/60),l=s.value%60;return`${String(r).padStart(2,"0")}:${String(l).padStart(2,"0")}`}),S=b(()=>{const r=Math.floor(o.value/60),l=o.value%60;return`${r}:${String(l).padStart(2,"0")}`}),M=async()=>{try{const r=await navigator.mediaDevices.getUserMedia({audio:!0}),l={mimeType:"audio/webm;codecs=opus"};MediaRecorder.isTypeSupported(l.mimeType)||(l.mimeType="audio/webm"),t.value=new MediaRecorder(r,l),d.value=[],t.value.ondataavailable=v=>{v.data.size>0&&d.value.push(v.data)},t.value.onstop=()=>{const v=new Blob(d.value,{type:"audio/webm"});e.value=v,o.value=s.value,r.getTracks().forEach(V=>V.stop()),n.value&&clearInterval(n.value);const I=new File([v],`voice-${Date.now()}.webm`,{type:"audio/webm"});a("recording-ready",{file:I,duration:o.value})},t.value.start(),c.value=!0,u.value=Date.now(),s.value=0,n.value=setInterval(()=>{s.value=Math.floor((Date.now()-u.value)/1e3)},1e3)}catch(r){console.error("Error accessing microphone:",r),alert("Could not access microphone. Please ensure microphone permissions are granted.")}},T=()=>{t.value&&c.value&&(t.value.stop(),c.value=!1)},D=()=>{t.value&&c.value&&(c.value=!1,e.value=null,d.value=[],t.value.stream&&t.value.stream.getTracks().forEach(r=>r.stop())),n.value&&(clearInterval(n.value),n.value=null),s.value=0,o.value=0},x=()=>{e.value=null,o.value=0,s.value=0,a("recording-removed")},C=()=>e.value?{file:new File([e.value],`voice-${Date.now()}.webm`,{type:"audio/webm"}),duration:o.value}:null;return B(()=>{n.value&&clearInterval(n.value)}),{isRecording:c,hasRecording:_,formattedTime:k,formattedDuration:S,startRecording:M,stopRecording:T,cancelRecording:D,deleteRecording:x,getRecordingData:C}}},P={class:"voice-recorder"},j={key:1,class:"recording-active"},A={class:"recording-time"},G={key:2,class:"voice-hidden-btn",style:{display:"none"}};function H(w,a,c,e,t,d){const u=y("Mic"),s=y("Square"),n=y("X");return p(),m("div",P,[!e.isRecording&&!e.hasRecording?(p(),m("button",{key:0,onClick:a[0]||(a[0]=(...o)=>e.startRecording&&e.startRecording(...o)),class:"voice-btn-bottom",title:"Record voice message"},[g(u,{size:16})])):R("",!0),e.isRecording?(p(),m("div",j,[a[3]||(a[3]=f("div",{class:"pulse-dot"},null,-1)),f("span",A,q(e.formattedTime),1),f("button",{onClick:a[1]||(a[1]=(...o)=>e.stopRecording&&e.stopRecording(...o)),class:"btn-stop-mini"},[g(s,{size:12})]),f("button",{onClick:a[2]||(a[2]=(...o)=>e.cancelRecording&&e.cancelRecording(...o)),class:"btn-cancel-mini"},[g(n,{size:12})])])):R("",!0),e.hasRecording&&!e.isRecording?(p(),m("button",G,[g(u,{size:14})])):R("",!0)])}const Q=z(L,[["render",H],["__scopeId","data-v-b850da87"]]);export{F as M,U as S,Q as V};
