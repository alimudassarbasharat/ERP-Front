import{H as N,l as u,p as S,y as _,f as p,o,D as g,d as t,a as r,h as s,ao as f,u as n,ap as b,F as y,z as v,ax as j,aw as z,an as k,t as w,ay as x,as as I,R as M}from"./index-xvPUEXLW.js";const P={class:"w-full mb-4"},T={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700"},H={key:0,class:"w-full mb-4"},L={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700"},R={class:"flex items-center justify-between mb-6"},U={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},q={class:"flex items-center justify-between"},G={class:"font-semibold text-gray-900 dark:text-white"},J={class:"text-sm text-gray-600 dark:text-gray-400"},K={key:1,class:"w-full mb-4"},O={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700"},Q={key:2,class:"w-full mb-4"},W={class:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700"},ee={__name:"Marksheets",setup(X){const d=N(),h=u([]),i=u(null),c=u([]),m=u(!1),C=async()=>{try{const e=await M.get("/exams");(e.data.success||e.data.status)&&(h.value=(e.data.result||e.data.data||[]).filter(l=>l.status==="published"))}catch(e){d.error("Failed to load exams"),console.error(e)}},$=async()=>{if(!i.value){c.value=[];return}try{const e=await M.get(`/exam-management/exams/${i.value}/marksheets`);e.data.success&&(c.value=e.data.data||[])}catch(e){d.error("Failed to load marksheets"),console.error(e)}},F=e=>{e.pdf_path?window.open(`/storage/${e.pdf_path}`,"_blank"):d.warning("Marksheet PDF is still being generated")},D=async()=>{m.value=!0;try{for(const e of c.value)e.pdf_path&&(window.open(`/storage/${e.pdf_path}`,"_blank"),await new Promise(l=>setTimeout(l,500)));d.success("All marksheets are opening")}catch{d.error("Failed to download marksheets")}finally{m.value=!1}};return S(()=>{C()}),(e,l)=>{const E=_("el-option"),V=_("el-select"),A=_("el-icon"),B=_("el-button");return o(),p(I,{title:"Marksheets",breadcrumbs:[{label:"Exam Management",route:"/exams/center"},{label:"Marksheets"}]},{default:g(()=>[t("div",P,[t("div",T,[s(f,{title:"Select Exam",icon:n(b)},null,8,["icon"]),s(V,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=a=>i.value=a),placeholder:"Choose an exam...",clearable:"",filterable:"",size:"large",class:"w-full",onChange:$},{default:g(()=>[(o(!0),r(y,null,v(h.value,a=>(o(),p(E,{key:a.id,label:a.name||a.term,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),c.value.length>0?(o(),r("div",H,[t("div",L,[t("div",R,[s(f,{title:"Available Marksheets",icon:n(j)},null,8,["icon"]),s(z,{label:"Download All",icon:n(k),variant:"primary",loading:m.value,onClick:D},null,8,["icon","loading"])]),t("div",U,[(o(!0),r(y,null,v(c.value,a=>(o(),r("div",{key:a.student_id,class:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600"},[t("div",q,[t("div",null,[t("p",G,w(a.student_name),1),t("p",J,"Student ID: "+w(a.student_id),1)]),s(B,{text:"",type:"primary",onClick:Y=>F(a)},{default:g(()=>[s(A,null,{default:g(()=>[s(n(k))]),_:1})]),_:1},8,["onClick"])])]))),128))])])])):i.value?(o(),r("div",K,[t("div",O,[s(x,{title:"No marksheets available",description:"No marksheets are available for this exam yet",icon:n(b),"icon-color":"gray"},null,8,["icon"])])])):(o(),r("div",Q,[t("div",W,[s(x,{title:"Select an exam",description:"Choose an exam from the dropdown above to view marksheets",icon:n(b),"icon-color":"blue"},null,8,["icon"])])]))]),_:1})}}};export{ee as default};
