import{_ as ve,p as be,H as Ve,l as u,Q as I,c as Ce,y as o,N as he,a as N,o as b,h as e,D as a,d as _,A as we,u as V,V as Fe,F as J,z as O,f as M,i,t as U,al as Se,X as De,Z as Pe,U as ke,an as xe,L as Ue}from"./index-xvPUEXLW.js";import{C as q}from"./CompactDatePicker-xqVnbMy9.js";import"./createVueComponent-mtWgRR3y.js";const ze={class:"fee-management-container"},Te={class:"card-header"},Ae={class:"header-actions"},Ne={class:"search-section"},Me={class:"pagination-container"},qe={class:"dialog-footer"},Be={class:"amount-due"},Ee={class:"dialog-footer"},Re={__name:"FeeManagement",setup(Le){console.log("FeeManagement component is loading"),be(()=>{console.log("FeeManagement component mounted")});const F=Ve(),Q=u(!1),S=u(""),D=u(""),P=u(""),y=u(null),v=u(1),j=n=>{y.value=n,A()},z=u(10),H=u(0),C=u(!1),h=u(!1),T=u(null),K=u([{id:1,name:"Class 1"},{id:2,name:"Class 2"},{id:3,name:"Class 3"}]),W=u([{id:"S001",name:"John Doe"},{id:"S002",name:"Jane Smith"},{id:"S003",name:"Mike Johnson"}]),X=u([{id:1,student_id:"S001",student_name:"John Doe",class:"Class 1",fee_type:"tuition",amount:5e4,due_date:"2024-03-15",status:"pending"},{id:2,student_id:"S002",student_name:"Jane Smith",class:"Class 2",fee_type:"registration",amount:1e4,due_date:"2024-03-20",status:"paid"}]),r=I({student_id:"",fee_type:"",amount:0,due_date:"",description:""}),d=I({amount:0,payment_date:"",payment_method:"",transaction_id:"",notes:""}),Y={student_id:[{required:!0,message:"Please select a student",trigger:"change"}],fee_type:[{required:!0,message:"Please select fee type",trigger:"change"}],amount:[{required:!0,message:"Please enter amount",trigger:"blur"}],due_date:[{required:!0,message:"Please select due date",trigger:"change"}]},Z={amount:[{required:!0,message:"Please enter payment amount",trigger:"blur"}],payment_date:[{required:!0,message:"Please select payment date",trigger:"change"}],payment_method:[{required:!0,message:"Please select payment method",trigger:"change"}]},G=Ce(()=>{let n=[...X.value];if(S.value){const t=S.value.toLowerCase();n=n.filter(m=>m.student_name.toLowerCase().includes(t)||m.student_id.toLowerCase().includes(t))}if(D.value&&(n=n.filter(t=>t.class===D.value)),P.value&&(n=n.filter(t=>t.status===P.value)),y.value&&y.value.length===2){const[t,m]=y.value;n=n.filter(p=>{const g=new Date(p.due_date);return g>=t&&g<=m})}return n}),B=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PKR"}).format(n),ee=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),te=n=>{switch(n){case"paid":return"success";case"pending":return"warning";case"overdue":return"danger";default:return"info"}},E=()=>{v.value=1},A=()=>{v.value=1},le=n=>{z.value=n,v.value=1},ae=n=>{v.value=n},ne=()=>{C.value=!0},oe=async()=>{console.log("Submitting fee:",r),F.success("Fee added successfully"),C.value=!1},se=n=>{T.value=n,d.amount=n.amount,h.value=!0},ue=async()=>{console.log("Processing payment:",d),F.success("Payment processed successfully"),h.value=!1},de=n=>{console.log("Viewing details for fee:",n)},re=n=>{Ue.confirm("Are you sure you want to delete this fee record?","Warning",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"}).then(()=>{console.log("Deleting fee:",n),F.success("Fee deleted successfully")}).catch(()=>{})},ie=()=>{console.log("Exporting fees"),F.success("Fees exported successfully")};return(n,t)=>{const m=o("el-icon"),p=o("el-button"),g=o("el-input"),k=o("el-col"),s=o("el-option"),w=o("el-select"),me=o("el-row"),f=o("el-table-column"),pe=o("el-tag"),ce=o("el-button-group"),fe=o("el-table"),_e=o("el-pagination"),ge=o("el-card"),c=o("el-form-item"),R=o("el-input-number"),L=o("el-form"),$=o("el-dialog"),ye=he("loading");return b(),N("div",ze,[e(ge,{class:"fee-management-card"},{header:a(()=>[_("div",Te,[t[22]||(t[22]=_("h2",{class:"title"},"Fee Management",-1)),_("div",Ae,[e(p,{type:"primary",onClick:ne},{default:a(()=>[e(m,null,{default:a(()=>[e(V(ke))]),_:1}),t[20]||(t[20]=i(" Add New Fee ",-1))]),_:1}),e(p,{type:"success",onClick:ie},{default:a(()=>[e(m,null,{default:a(()=>[e(V(xe))]),_:1}),t[21]||(t[21]=i(" Export Fees ",-1))]),_:1})])])]),default:a(()=>[_("div",Ne,[e(me,{gutter:20},{default:a(()=>[e(k,{span:6},{default:a(()=>[e(g,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=l=>S.value=l),placeholder:"Search by student name or ID",clearable:"",onClear:E,onInput:E},{prefix:a(()=>[e(m,null,{default:a(()=>[e(V(Fe))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(k,{span:6},{default:a(()=>[e(w,{modelValue:D.value,"onUpdate:modelValue":t[1]||(t[1]=l=>D.value=l),placeholder:"Select Class",clearable:"",onChange:A},{default:a(()=>[(b(!0),N(J,null,O(K.value,l=>(b(),M(s,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(k,{span:6},{default:a(()=>[e(w,{modelValue:P.value,"onUpdate:modelValue":t[2]||(t[2]=l=>P.value=l),placeholder:"Payment Status",clearable:"",onChange:A},{default:a(()=>[e(s,{label:"Paid",value:"paid"}),e(s,{label:"Pending",value:"pending"}),e(s,{label:"Overdue",value:"overdue"})]),_:1},8,["modelValue"])]),_:1}),e(k,{span:6},{default:a(()=>[e(q,{modelValue:y.value,"onUpdate:modelValue":t[3]||(t[3]=l=>y.value=l),placeholder:"",onChange:j},null,8,["modelValue"])]),_:1})]),_:1})]),we((b(),M(fe,{data:G.value,style:{width:"100%"},border:"",stripe:""},{default:a(()=>[e(f,{prop:"student_id",label:"Student ID",width:"120"}),e(f,{prop:"student_name",label:"Student Name","min-width":"180"}),e(f,{prop:"class",label:"Class",width:"120"}),e(f,{prop:"fee_type",label:"Fee Type",width:"150"}),e(f,{prop:"amount",label:"Amount",width:"120"},{default:a(({row:l})=>[i(U(B(l.amount)),1)]),_:1}),e(f,{prop:"due_date",label:"Due Date",width:"120"},{default:a(({row:l})=>[i(U(ee(l.due_date)),1)]),_:1}),e(f,{prop:"status",label:"Status",width:"120"},{default:a(({row:l})=>[e(pe,{type:te(l.status)},{default:a(()=>[i(U(l.status),1)]),_:2},1032,["type"])]),_:1}),e(f,{label:"Actions",width:"200",fixed:"right"},{default:a(({row:l})=>[e(ce,null,{default:a(()=>[e(p,{type:"primary",size:"small",onClick:x=>se(l),disabled:l.status==="paid"},{default:a(()=>[e(m,null,{default:a(()=>[e(V(Se))]),_:1}),t[23]||(t[23]=i(" Pay ",-1))]),_:1},8,["onClick","disabled"]),e(p,{type:"info",size:"small",onClick:x=>de(l)},{default:a(()=>[e(m,null,{default:a(()=>[e(V(De))]),_:1}),t[24]||(t[24]=i(" View ",-1))]),_:1},8,["onClick"]),e(p,{type:"danger",size:"small",onClick:x=>re(l)},{default:a(()=>[e(m,null,{default:a(()=>[e(V(Pe))]),_:1}),t[25]||(t[25]=i(" Delete ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ye,Q.value]]),_("div",Me,[e(_e,{"current-page":v.value,"onUpdate:currentPage":t[4]||(t[4]=l=>v.value=l),"page-size":z.value,"onUpdate:pageSize":t[5]||(t[5]=l=>z.value=l),"page-sizes":[10,20,50,100],total:H.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:le,onCurrentChange:ae},null,8,["current-page","page-size","total"])])]),_:1}),e($,{modelValue:C.value,"onUpdate:modelValue":t[12]||(t[12]=l=>C.value=l),title:"Add New Fee",width:"50%","close-on-click-modal":!1},{footer:a(()=>[_("span",qe,[e(p,{onClick:t[11]||(t[11]=l=>C.value=!1)},{default:a(()=>[...t[26]||(t[26]=[i("Cancel",-1)])]),_:1}),e(p,{type:"primary",onClick:oe},{default:a(()=>[...t[27]||(t[27]=[i("Submit",-1)])]),_:1})])]),default:a(()=>[e(L,{ref:"feeFormRef",model:r,rules:Y,"label-width":"120px"},{default:a(()=>[e(c,{label:"Student",prop:"student_id"},{default:a(()=>[e(w,{modelValue:r.student_id,"onUpdate:modelValue":t[6]||(t[6]=l=>r.student_id=l),placeholder:"Select Student",filterable:"",style:{width:"100%"}},{default:a(()=>[(b(!0),N(J,null,O(W.value,l=>(b(),M(s,{key:l.id,label:`${l.name} (${l.id})`,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"Fee Type",prop:"fee_type"},{default:a(()=>[e(w,{modelValue:r.fee_type,"onUpdate:modelValue":t[7]||(t[7]=l=>r.fee_type=l),placeholder:"Select Fee Type",style:{width:"100%"}},{default:a(()=>[e(s,{label:"Tuition Fee",value:"tuition"}),e(s,{label:"Registration Fee",value:"registration"}),e(s,{label:"Exam Fee",value:"exam"}),e(s,{label:"Library Fee",value:"library"}),e(s,{label:"Transport Fee",value:"transport"}),e(s,{label:"Other",value:"other"})]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"Amount",prop:"amount"},{default:a(()=>[e(R,{modelValue:r.amount,"onUpdate:modelValue":t[8]||(t[8]=l=>r.amount=l),min:0,precision:2,step:1e3,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(c,{label:"Due Date",prop:"due_date"},{default:a(()=>[e(q,{modelValue:r.due_date,"onUpdate:modelValue":t[9]||(t[9]=l=>r.due_date=l),placeholder:""},null,8,["modelValue"])]),_:1}),e(c,{label:"Description",prop:"description"},{default:a(()=>[e(g,{modelValue:r.description,"onUpdate:modelValue":t[10]||(t[10]=l=>r.description=l),type:"textarea",rows:3,placeholder:"Enter fee description"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e($,{modelValue:h.value,"onUpdate:modelValue":t[19]||(t[19]=l=>h.value=l),title:"Process Payment",width:"40%","close-on-click-modal":!1},{footer:a(()=>[_("span",Ee,[e(p,{onClick:t[18]||(t[18]=l=>h.value=!1)},{default:a(()=>[...t[28]||(t[28]=[i("Cancel",-1)])]),_:1}),e(p,{type:"primary",onClick:ue},{default:a(()=>[...t[29]||(t[29]=[i("Process Payment",-1)])]),_:1})])]),default:a(()=>[e(L,{ref:"paymentFormRef",model:d,rules:Z,"label-width":"120px"},{default:a(()=>[e(c,{label:"Amount Due"},{default:a(()=>{var l;return[_("span",Be,U(B((l=T.value)==null?void 0:l.amount)),1)]}),_:1}),e(c,{label:"Payment Amount",prop:"amount"},{default:a(()=>{var l;return[e(R,{modelValue:d.amount,"onUpdate:modelValue":t[13]||(t[13]=x=>d.amount=x),min:0,max:(l=T.value)==null?void 0:l.amount,precision:2,step:1e3,style:{width:"100%"}},null,8,["modelValue","max"])]}),_:1}),e(c,{label:"Payment Date",prop:"payment_date"},{default:a(()=>[e(q,{modelValue:d.payment_date,"onUpdate:modelValue":t[14]||(t[14]=l=>d.payment_date=l),placeholder:""},null,8,["modelValue"])]),_:1}),e(c,{label:"Payment Method",prop:"payment_method"},{default:a(()=>[e(w,{modelValue:d.payment_method,"onUpdate:modelValue":t[15]||(t[15]=l=>d.payment_method=l),placeholder:"Select payment method",style:{width:"100%"}},{default:a(()=>[e(s,{label:"Cash",value:"cash"}),e(s,{label:"Bank Transfer",value:"bank_transfer"}),e(s,{label:"Credit Card",value:"credit_card"}),e(s,{label:"Check",value:"check"})]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"Transaction ID",prop:"transaction_id"},{default:a(()=>[e(g,{modelValue:d.transaction_id,"onUpdate:modelValue":t[16]||(t[16]=l=>d.transaction_id=l),placeholder:"Enter transaction ID"},null,8,["modelValue"])]),_:1}),e(c,{label:"Notes",prop:"notes"},{default:a(()=>[e(g,{modelValue:d.notes,"onUpdate:modelValue":t[17]||(t[17]=l=>d.notes=l),type:"textarea",rows:3,placeholder:"Enter payment notes"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Oe=ve(Re,[["__scopeId","data-v-bdf4ec4a"]]);export{Oe as default};
