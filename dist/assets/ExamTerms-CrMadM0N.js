import{H as O,l as f,p as L,R as y,y as D,N as R,a as w,o as v,d as t,i as n,b as S,h as r,u as U,U as H,A as i,f as F,D as u,t as p,aM as J,ay as K,J as $,B as P,F as G,z as Q,K as c,aA as E}from"./index-xvPUEXLW.js";import{_ as W}from"./StatusChip--xfdpyNX.js";const X={class:"relative w-full min-h-screen pl-0 pr-0 sm:pl-0 sm:pr-0 lg:pl-1 lg:pr-0 py-2 sm:py-3 lg:py-4"},Y={class:"relative z-10 w-full mt-2 mb-4 flex items-center justify-between bg-white/90 rounded-lg shadow-lg py-2 px-5 transition-all duration-500 border border-gray-200"},Z={class:"flex items-center gap-2 text-base font-medium text-gray-600"},ee={class:"relative z-10 w-full"},te={class:"mb-4 flex items-center justify-between"},se={class:"bg-white/90 rounded-xl shadow-lg border border-gray-200"},le={class:"font-semibold text-gray-900 dark:text-gray-100"},ae={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},oe={class:"text-gray-600 dark:text-gray-400"},ne={class:"px-6 py-4 border-b border-gray-200"},re={class:"text-lg font-semibold text-gray-900"},ie={class:"flex flex-col w-full"},de={class:"relative"},ue=["disabled"],pe=["value"],me={class:"flex flex-col w-full"},fe={class:"relative"},ve={class:"flex flex-col w-full"},xe={class:"relative"},ce={class:"flex flex-col w-full"},ge={class:"relative"},be={class:"flex flex-col w-full"},ye={class:"relative"},we={class:"flex flex-col w-full"},_e={class:"flex gap-4"},he={class:"flex items-center gap-2 cursor-pointer"},ke={class:"flex items-center gap-2 cursor-pointer"},Te={class:"flex flex-col w-full"},Ce={class:"relative"},De={class:"flex flex-col w-full"},Se={class:"relative"},Ve={class:"flex gap-3 pt-4"},Me=["disabled"],Ee={__name:"ExamTerms",setup(Ue){const d=O(),_=f(!1),h=f(!1),k=f([]),V=f([]),x=f(!1),m=f(null),a=f({session_id:null,name:"",code:"",start_date:null,end_date:null,status:"active",order:0,description:""});L(()=>{T(),N()});const N=async()=>{try{const l=await y.get("/sessions/select-options");V.value=l.data.result||[]}catch(l){console.error("Failed to load sessions:",l)}},T=async()=>{_.value=!0;try{const l=await y.get("/exam-terms");l.data.success&&(k.value=l.data.data||[])}catch(l){d.error("Failed to load terms"),console.error(l)}finally{_.value=!1}},z=async()=>{var l,e;if(!a.value.session_id||!a.value.name||!a.value.start_date||!a.value.end_date){d.error("Please fill all required fields");return}if(new Date(a.value.end_date)<=new Date(a.value.start_date)){d.error("End date must be after start date");return}h.value=!0;try{m.value?(await y.put(`/exam-terms/${m.value.id}`,a.value),d.success("Term updated successfully")):(await y.post("/exam-terms",a.value),d.success("Term created successfully")),x.value=!1,q(),T()}catch(o){d.error(((e=(l=o.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to save term")}finally{h.value=!1}},A=l=>{m.value=l,a.value={session_id:l.session_id,name:l.name,code:l.code||"",start_date:l.start_date,end_date:l.end_date,status:l.status,order:l.order||0,description:l.description||""},x.value=!0},B=async l=>{var e,o,g;if(((e=l.exams)==null?void 0:e.length)>0){d.error("Cannot delete term: It has associated exams");return}try{await y.delete(`/exam-terms/${l.id}`),d.success("Term deleted successfully"),T()}catch(C){d.error(((g=(o=C.response)==null?void 0:o.data)==null?void 0:g.message)||"Failed to delete term")}},q=()=>{m.value=null,a.value={session_id:null,name:"",code:"",start_date:null,end_date:null,status:"active",order:0,description:""}},M=l=>l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-";return(l,e)=>{const o=D("el-table-column"),g=D("el-button"),C=D("el-table"),j=R("loading");return v(),w("div",X,[t("div",Y,[e[16]||(e[16]=t("h2",{class:"text-base font-medium text-gray-900 tracking-tight flex items-center gap-2"},[t("div",{class:"w-2 h-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full animate-pulse"}),n(" Exam Terms Management ")],-1)),t("nav",Z,[t("span",{class:"hover:text-purple-600 cursor-pointer transition-colors duration-200",onClick:e[0]||(e[0]=s=>l.$router.push("/exams/center"))},"Exam Management"),e[14]||(e[14]=t("span",{class:"mx-2"},"|",-1)),e[15]||(e[15]=t("span",{class:"text-gray-900 font-bold"},"Terms",-1))])]),t("div",ee,[t("div",te,[t("button",{onClick:e[1]||(e[1]=s=>x.value=!0),class:"h-10 px-6 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 text-sm font-bold text-white shadow hover:from-purple-600 hover:to-pink-600 transition-all duration-300 flex items-center gap-2"},[r(U(H),{class:"w-4 h-4"}),e[17]||(e[17]=n(" Add Term ",-1))])]),t("div",se,[i((v(),F(C,{data:k.value,stripe:"",style:{width:"100%"}},{default:u(()=>[r(o,{prop:"name",label:"Term Name","min-width":"150"},{default:u(({row:s})=>[t("div",le,p(s.name),1),s.code?(v(),w("div",ae,p(s.code),1)):S("",!0)]),_:1}),r(o,{prop:"start_date",label:"Start Date",width:"120"},{default:u(({row:s})=>[n(p(M(s.start_date)),1)]),_:1}),r(o,{prop:"end_date",label:"End Date",width:"120"},{default:u(({row:s})=>[n(p(M(s.end_date)),1)]),_:1}),r(o,{prop:"status",label:"Status",width:"100"},{default:u(({row:s})=>[r(W,{status:s.status,labels:{active:"Active",inactive:"Inactive"}},null,8,["status"])]),_:1}),r(o,{prop:"exams_count",label:"Exams",width:"80",align:"center"},{default:u(({row:s})=>{var b;return[t("span",oe,p(((b=s.exams)==null?void 0:b.length)||0),1)]}),_:1}),r(o,{label:"Actions",width:"150",fixed:"right"},{default:u(({row:s})=>{var b;return[r(g,{type:"primary",link:"",size:"small",onClick:I=>A(s)},{default:u(()=>[...e[18]||(e[18]=[n(" Edit ",-1)])]),_:1},8,["onClick"]),r(g,{type:"danger",link:"",size:"small",onClick:I=>B(s),disabled:((b=s.exams)==null?void 0:b.length)>0},{default:u(()=>[...e[19]||(e[19]=[n(" Delete ",-1)])]),_:1},8,["onClick","disabled"])]}),_:1})]),_:1},8,["data"])),[[j,_.value]]),!_.value&&k.value.length===0?(v(),F(K,{key:0,title:"No Terms Found",description:"Create your first exam term to get started",icon:U(J)},null,8,["icon"])):S("",!0)]),x.value?(v(),w("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e[13]||(e[13]=s=>x.value=!1)},[t("div",{class:"bg-white rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-300",onClick:e[12]||(e[12]=$(()=>{},["stop"]))},[t("div",ne,[t("h3",re,p(m.value?"Edit Term":"Create Term"),1)]),t("form",{onSubmit:$(z,["prevent"]),class:"p-6 space-y-4"},[t("div",ie,[e[23]||(e[23]=t("label",{class:"mb-1 text-xs font-semibold text-gray-600 uppercase tracking-wider"},[n("Session "),t("span",{class:"text-red-500"},"*")],-1)),t("div",de,[i(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.session_id=s),required:"",disabled:m.value,class:"h-10 border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full appearance-none pr-8"},[e[20]||(e[20]=t("option",{value:""},"Select Session",-1)),(v(!0),w(G,null,Q(V.value,s=>(v(),w("option",{key:s.id,value:s.id},p(s.name),9,pe))),128))],8,ue),[[P,a.value.session_id]]),e[21]||(e[21]=t("div",{class:"absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"},[t("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor","stroke-width":"1.5",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 5v14m0 0l-5-5m5 5l5-5"})])],-1)),e[22]||(e[22]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",me,[e[25]||(e[25]=t("label",{class:"mb-1 text-xs font-semibold text-gray-600 uppercase tracking-wider"},[n("Term Name "),t("span",{class:"text-red-500"},"*")],-1)),t("div",fe,[i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.name=s),type:"text",placeholder:"e.g., Term-1, Midterm, Final",required:"",class:"h-10 border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full"},null,512),[[c,a.value.name]]),e[24]||(e[24]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",ve,[e[27]||(e[27]=t("label",{class:"mb-1 text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Code (Optional)",-1)),t("div",xe,[i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.code=s),type:"text",placeholder:"e.g., T1, MT, F",class:"h-10 border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full"},null,512),[[c,a.value.code]]),e[26]||(e[26]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",ce,[e[29]||(e[29]=t("label",{class:"mb-1 text-xs font-semibold text-gray-600 uppercase tracking-wider"},[n("Start Date "),t("span",{class:"text-red-500"},"*")],-1)),t("div",ge,[i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.start_date=s),type:"date",required:"",class:"h-10 border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full"},null,512),[[c,a.value.start_date]]),e[28]||(e[28]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",be,[e[31]||(e[31]=t("label",{class:"mb-1 text-xs font-semibold text-gray-600 uppercase tracking-wider"},[n("End Date "),t("span",{class:"text-red-500"},"*")],-1)),t("div",ye,[i(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>a.value.end_date=s),type:"date",required:"",class:"h-10 border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full"},null,512),[[c,a.value.end_date]]),e[30]||(e[30]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",we,[e[34]||(e[34]=t("label",{class:"mb-1 text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Status",-1)),t("div",_e,[t("label",he,[i(t("input",{type:"radio","onUpdate:modelValue":e[7]||(e[7]=s=>a.value.status=s),value:"active",class:"w-4 h-4 text-purple-600 focus:ring-purple-500"},null,512),[[E,a.value.status]]),e[32]||(e[32]=t("span",{class:"text-sm text-gray-600"},"Active",-1))]),t("label",ke,[i(t("input",{type:"radio","onUpdate:modelValue":e[8]||(e[8]=s=>a.value.status=s),value:"inactive",class:"w-4 h-4 text-purple-600 focus:ring-purple-500"},null,512),[[E,a.value.status]]),e[33]||(e[33]=t("span",{class:"text-sm text-gray-600"},"Inactive",-1))])])]),t("div",Te,[e[36]||(e[36]=t("label",{class:"mb-1 text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Order",-1)),t("div",Ce,[i(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>a.value.order=s),type:"number",min:"0",class:"h-10 border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full"},null,512),[[c,a.value.order,void 0,{number:!0}]]),e[35]||(e[35]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",De,[e[38]||(e[38]=t("label",{class:"mb-1 text-xs font-semibold text-gray-600 uppercase tracking-wider"},"Description",-1)),t("div",Se,[i(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=s=>a.value.description=s),placeholder:"Optional description",rows:"3",class:"border-0 bg-transparent px-0 text-sm font-light text-gray-600 focus:ring-0 focus:outline-none w-full resize-none"},null,512),[[c,a.value.description]]),e[37]||(e[37]=t("div",{class:"absolute left-0 right-0 bottom-0 h-[2px] bg-purple-200 pointer-events-none"},null,-1))])]),t("div",Ve,[t("button",{type:"button",onClick:e[11]||(e[11]=s=>x.value=!1),class:"flex-1 h-10 px-6 rounded-full bg-gradient-to-r from-gray-500 to-slate-500 text-sm font-bold text-white shadow hover:from-gray-600 hover:to-slate-600 transition-all duration-300"}," Cancel "),t("button",{type:"submit",disabled:h.value,class:"flex-1 h-10 px-6 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 text-sm font-bold text-white shadow hover:from-purple-600 hover:to-pink-600 transition-all duration-300 disabled:opacity-50"},p(h.value?"Saving...":m.value?"Update":"Create"),9,Me)])],32)])])):S("",!0)])])}}};export{Ee as default};
