import{_ as x,y as b,a as l,o as d,d as t,b as c,i as u,t as g,f as k,C as v,F as w,z as _,e as m,J as S,A as h,K as y,H as C}from"./index-xvPUEXLW.js";import{T as D}from"./TableLoader-DpFqaoeq.js";const T={name:"SessionManagement",components:{TableLoader:D},data(){return{sessions:[],statistics:{total_sessions:0,active_sessions:0,draft_sessions:0,archived_sessions:0},showModal:!1,editingSession:null,loading:!1,saving:!1,formData:{name:"",description:"",start_date:"",end_date:"",notes:""},errors:{}}},setup(){return{toast:C()}},async mounted(){try{this.getApiClient(),await this.loadSessions()}catch(r){console.error("Component initialization error:",r),this.toast&&this.toast.error("Failed to initialize. Please refresh the page.")}},methods:{getApiClient(){if(this.$api&&typeof this.$api.get=="function")return this.$api;if(this.$http&&typeof this.$http.get=="function")return this.$http;if(window.axios&&typeof window.axios.get=="function")return window.axios;const r=new Error("API client not available. Please refresh the page.");throw console.error("API Client Error:",r),r},showToast(r,e){this.toast&&typeof this.toast[r]=="function"?this.toast[r](e):console[r==="error"?"error":"log"](`${r.toUpperCase()}: ${e}`)},async loadSessions(){var r,e;this.loading=!0;try{const a=await this.getApiClient().get("/sessions");console.log("Sessions API Response:",a==null?void 0:a.data),a&&a.data&&a.data.success?(a.data.data?(this.sessions=a.data.data.sessions||a.data.data||[],this.statistics=a.data.data.statistics||this.statistics):Array.isArray(a.data)?this.sessions=a.data:this.sessions=[],console.log("Loaded sessions:",this.sessions),console.log("Statistics:",this.statistics)):(console.warn("Unexpected response structure:",a==null?void 0:a.data),this.sessions=[])}catch(i){console.error("Failed to load sessions:",i);const a=((e=(r=i==null?void 0:i.response)==null?void 0:r.data)==null?void 0:e.message)||(i==null?void 0:i.message)||"Failed to load sessions";this.showToast("error",a),this.sessions=[]}finally{this.loading=!1}},openCreateModal(){this.editingSession=null,this.formData={name:"",description:"",start_date:"",end_date:"",notes:""},this.errors={},this.showModal=!0},editSession(r){this.editingSession=r,this.formData={name:r.name||"",description:r.description||"",start_date:r.start_date||"",end_date:r.end_date||"",notes:r.notes||""},this.errors={},this.showModal=!0},closeModal(){this.showModal=!1,this.editingSession=null,this.errors={}},async saveSession(){var r;if(!this.formData.name||!this.formData.name.trim()){this.errors.name="Session name is required",this.showToast("error","Please enter a session name");return}if(!this.formData.start_date){this.errors.start_date="Start date is required",this.showToast("error","Please select a start date");return}if(!this.formData.end_date){this.errors.end_date="End date is required",this.showToast("error","Please select an end date");return}if(new Date(this.formData.start_date)>=new Date(this.formData.end_date)){this.errors.end_date="End date must be after start date",this.showToast("error","End date must be after start date");return}this.saving=!0,this.errors={};try{const e=this.getApiClient();let i;this.editingSession&&this.editingSession.id?i=await e.post(`/sessions/${this.editingSession.id}/update`,this.formData):i=await e.post("/sessions/store",this.formData),i&&i.data&&i.data.success?(this.showToast("success",this.editingSession?"Session updated successfully":"Session created successfully"),this.closeModal(),await this.loadSessions()):this.showToast("error",((r=i==null?void 0:i.data)==null?void 0:r.message)||"Failed to save session")}catch(e){if(console.error("Save error:",e),e.response&&e.response.status===422){const i=e.response.data||{};let a="Validation failed. Please check the form.";if(i.errors&&typeof i.errors=="object"){this.errors=i.errors;const s=Object.values(i.errors)[0];Array.isArray(s)&&s.length>0?a=s[0]:typeof s=="string"&&(a=s)}else i.message&&(a=i.message);this.showToast("error",a)}else if(e.response&&e.response.data){const i=e.response.data;let a="Failed to save session. Please try again.";if(i.message)a=i.message,(a.includes("duplicate key")||a.includes("Unique violation"))&&(a.includes("sessions_name_unique")?a="A session with this name already exists. Please choose a different name.":a="This session name is already taken. Please choose a different name.");else if(i.error){const s=i.error;s.includes("duplicate key")||s.includes("Unique violation")?s.includes("sessions_name_unique")?a="A session with this name already exists. Please choose a different name.":a="This session name is already taken. Please choose a different name.":a=s}this.showToast("error",a)}else e.message?this.showToast("error",e.message):this.showToast("error","Failed to save session. Please try again.")}finally{this.saving=!1}},async activateSession(r){var e,i,a;if(!r||!r.id){this.showToast("error","Invalid session data");return}if(confirm(`Are you sure you want to activate "${r.name||"this session"}"? This will deactivate all other sessions.`))try{const n=await this.getApiClient().post(`/sessions/${r.id}/activate`);n&&n.data&&n.data.success?(this.showToast("success","Session activated successfully"),await this.loadSessions()):this.showToast("error",((e=n==null?void 0:n.data)==null?void 0:e.message)||"Failed to activate session")}catch(s){console.error("Activation error:",s),this.showToast("error",((a=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:a.message)||(s==null?void 0:s.message)||"Failed to activate session")}},async archiveSession(r){var e,i,a;if(!r||!r.id){this.showToast("error","Invalid session data");return}if(confirm(`Are you sure you want to archive "${r.name||"this session"}"?`))try{const n=await this.getApiClient().post(`/sessions/${r.id}/archive`);n&&n.data&&n.data.success?(this.showToast("success","Session archived successfully"),await this.loadSessions()):this.showToast("error",((e=n==null?void 0:n.data)==null?void 0:e.message)||"Failed to archive session")}catch(s){console.error("Archive error:",s),this.showToast("error",((a=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:a.message)||(s==null?void 0:s.message)||"Failed to archive session")}},async deleteSession(r){var e,i,a;if(!r||!r.id){this.showToast("error","Invalid session data");return}if(confirm(`Are you sure you want to delete "${r.name||"this session"}"? This action cannot be undone.`))try{const n=await this.getApiClient().delete(`/sessions/${r.id}`);n&&n.data&&n.data.success?(this.showToast("success","Session deleted successfully"),await this.loadSessions()):this.showToast("error",((e=n==null?void 0:n.data)==null?void 0:e.message)||"Failed to delete session")}catch(s){console.error("Delete error:",s),this.showToast("error",((a=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:a.message)||(s==null?void 0:s.message)||"Failed to delete session")}},formatDate(r){if(!r)return"";try{const e=new Date(r);return isNaN(e.getTime())?"":e.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return""}},getDuration(r){if(!r||!r.start_date||!r.end_date)return"N/A";try{const e=new Date(r.start_date),i=new Date(r.end_date);return isNaN(e.getTime())||isNaN(i.getTime())?"N/A":`${Math.ceil((i-e)/(1e3*60*60*24))+1} days`}catch{return"N/A"}}}},A={class:"min-h-screen flex flex-col items-center p-4 sm:p-6 lg:p-8",style:{background:"var(--bg-primary)"}},M={class:"w-full max-w-6xl mx-auto mt-2 mb-4 flex items-center justify-between bg-white/90 dark:bg-gray-800/90 rounded-lg shadow-lg py-2 px-5 transition-all duration-500 border border-gray-200 dark:border-gray-700"},N={class:"flex items-center gap-2 text-base font-medium text-gray-600 dark:text-gray-400"},P={class:"w-full max-w-6xl mx-auto mb-6 grid grid-cols-1 md:grid-cols-4 gap-4"},F={class:"bg-white dark:bg-gray-800/90 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},j={class:"text-2xl font-bold text-gray-900 dark:text-white"},V={class:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-700"},E={class:"text-2xl font-bold text-green-700 dark:text-green-400"},U={class:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-700"},L={class:"text-2xl font-bold text-yellow-700 dark:text-yellow-400"},q={class:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},B={class:"text-2xl font-bold text-gray-700 dark:text-gray-400"},I={class:"w-full max-w-6xl mx-auto"},z={class:"bg-white dark:bg-gray-800/90 rounded-xl shadow-lg overflow-hidden border border-gray-200 dark:border-gray-700"},H={class:"bg-gray-50 dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between"},J={key:1,class:"p-12 text-center"},K={class:"flex flex-col items-center justify-center"},O={key:2,class:"overflow-x-auto"},R={class:"w-full"},G={class:"divide-y divide-gray-200 dark:divide-gray-700 bg-white dark:bg-gray-800"},Q={class:"px-6 py-4"},W={class:"flex items-center gap-2"},X={key:0,class:"w-2 h-2 bg-green-500 rounded-full"},Y={class:"font-medium text-gray-900 dark:text-white"},Z={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},$={class:"px-6 py-4 text-sm text-gray-700 dark:text-gray-300"},ee={key:0},te={key:1,class:"text-gray-400"},se={class:"px-6 py-4 text-sm text-gray-700 dark:text-gray-300"},re={class:"px-6 py-4"},ae={class:"px-6 py-4 text-right"},oe={class:"flex items-center justify-end gap-2"},ie=["onClick"],ne=["onClick"],de=["onClick"],le=["onClick"],ge={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},ce={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},ue={class:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-6"},he={class:"flex items-center justify-between"},ye={class:"text-xl font-bold text-gray-900 dark:text-white"},me={key:0,class:"text-red-500 text-sm mt-1"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fe={key:0,class:"text-red-500 text-sm mt-1"},xe={key:0,class:"text-red-500 text-sm mt-1"},be={class:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"},ke=["disabled"],ve={key:0,class:"flex items-center gap-2"},we={key:1};function _e(r,e,i,a,s,n){const f=b("TableLoader");return d(),l("div",A,[t("div",M,[e[15]||(e[15]=t("h2",{class:"text-base font-medium text-gray-900 dark:text-white tracking-tight flex items-center gap-2"},[t("div",{class:"w-2 h-2 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full animate-pulse"}),u(" Session Management ")],-1)),t("nav",N,[t("span",{class:"hover:text-pink-600 dark:hover:text-pink-400 cursor-pointer transition-colors duration-200",onClick:e[0]||(e[0]=o=>r.$router.push("/dashboard"))},"Dashboard"),e[12]||(e[12]=t("span",{class:"mx-2 dark:text-gray-600"},"|",-1)),t("span",{class:"hover:text-pink-600 dark:hover:text-pink-400 cursor-pointer transition-colors duration-200",onClick:e[1]||(e[1]=o=>r.$router.push("/settings"))},"Settings"),e[13]||(e[13]=t("span",{class:"mx-2 dark:text-gray-600"},"|",-1)),e[14]||(e[14]=t("span",{class:"text-gray-900 dark:text-white font-bold"},"Sessions",-1))])]),t("div",P,[t("div",F,[e[16]||(e[16]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Total Sessions",-1)),t("div",j,g(s.statistics.total_sessions),1)]),t("div",V,[e[17]||(e[17]=t("div",{class:"text-sm text-green-600 dark:text-green-400 mb-1"},"Active Sessions",-1)),t("div",E,g(s.statistics.active_sessions),1)]),t("div",U,[e[18]||(e[18]=t("div",{class:"text-sm text-yellow-600 dark:text-yellow-400 mb-1"},"Draft Sessions",-1)),t("div",L,g(s.statistics.draft_sessions),1)]),t("div",q,[e[19]||(e[19]=t("div",{class:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Archived Sessions",-1)),t("div",B,g(s.statistics.archived_sessions),1)])]),t("div",I,[t("div",z,[t("div",H,[e[21]||(e[21]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Academic Sessions",-1)),t("button",{onClick:e[2]||(e[2]=(...o)=>n.openCreateModal&&n.openCreateModal(...o)),class:"px-4 py-2 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white rounded-lg transition-all duration-200 flex items-center gap-2"},[...e[20]||(e[20]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" Create Session ",-1)])])]),s.loading?(d(),k(f,{key:0,message:"Loading sessions..."})):!s.loading&&s.sessions.length===0?(d(),l("div",J,[t("div",K,[e[22]||(e[22]=v('<div class="w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mb-4" data-v-645e16fb><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-645e16fb><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-645e16fb></path></svg></div><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2" data-v-645e16fb>No sessions found</h3><p class="text-gray-500 dark:text-gray-400 mb-4" data-v-645e16fb>Create your first academic session to get started.</p>',3)),t("button",{onClick:e[3]||(e[3]=(...o)=>n.openCreateModal&&n.openCreateModal(...o)),class:"px-4 py-2 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white rounded-lg transition-all duration-200"}," Create Session ")])])):!s.loading&&s.sessions.length>0?(d(),l("div",O,[t("table",R,[e[23]||(e[23]=t("thead",{class:"bg-gray-50 dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Session Name"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Dates"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Duration"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Status"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",G,[(d(!0),l(w,null,_(s.sessions,o=>(d(),l("tr",{key:o.id,class:"hover:bg-gray-50 dark:hover:bg-gray-900/30 transition-colors duration-200"},[t("td",Q,[t("div",W,[o.is_active?(d(),l("div",X)):c("",!0),t("div",null,[t("div",Y,g(o.name),1),o.description?(d(),l("div",Z,g(o.description),1)):c("",!0)])])]),t("td",$,[o.start_date&&o.end_date?(d(),l("div",ee,g(n.formatDate(o.start_date))+" - "+g(n.formatDate(o.end_date)),1)):(d(),l("div",te,"Not set"))]),t("td",se,g(n.getDuration(o)),1),t("td",re,[t("span",{class:m(["px-3 py-1 rounded-full text-xs font-medium",o.is_active?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":o.status==="draft"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-400"])},g(o.is_active?"Active":o.status),3)]),t("td",ae,[t("div",oe,[!o.is_active&&o.status!=="archived"?(d(),l("button",{key:0,onClick:p=>n.activateSession(o),class:"px-3 py-1 bg-green-100 hover:bg-green-200 dark:bg-green-900/20 dark:hover:bg-green-900/30 text-green-700 dark:text-green-400 rounded-lg transition-all duration-200 text-sm"}," Activate ",8,ie)):c("",!0),o.is_active?(d(),l("button",{key:1,onClick:p=>n.archiveSession(o),class:"px-3 py-1 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-all duration-200 text-sm"}," Archive ",8,ne)):c("",!0),t("button",{onClick:p=>n.editSession(o),class:"px-3 py-1 bg-blue-100 hover:bg-blue-200 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 text-blue-700 dark:text-blue-400 rounded-lg transition-all duration-200 text-sm"}," Edit ",8,de),o.is_active?c("",!0):(d(),l("button",{key:2,onClick:p=>n.deleteSession(o),class:"px-3 py-1 bg-red-100 hover:bg-red-200 dark:bg-red-900/20 dark:hover:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg transition-all duration-200 text-sm"}," Delete ",8,le))])])]))),128))])])])):c("",!0)])]),s.showModal?(d(),l("div",ge,[t("div",ce,[t("div",ue,[t("div",he,[t("h3",ye,g(s.editingSession?"Edit Session":"Create New Session"),1),t("button",{onClick:e[4]||(e[4]=(...o)=>n.closeModal&&n.closeModal(...o)),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...e[24]||(e[24]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),t("form",{onSubmit:e[11]||(e[11]=S((...o)=>n.saveSession&&n.saveSession(...o),["prevent"])),class:"p-6 space-y-6"},[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[u(" Session Name "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>s.formData.name=o),type:"text",class:m(["w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-all duration-200",s.errors.name?"border-red-500":"border-gray-300 dark:border-gray-600"]),placeholder:"e.g., 2025-2026"},null,2),[[y,s.formData.name]]),s.errors.name?(d(),l("p",me,g(s.errors.name),1)):c("",!0)]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Description ",-1)),h(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.formData.description=o),rows:"3",class:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-all duration-200",placeholder:"Academic session 2025-2026"},null,512),[[y,s.formData.description]])]),t("div",pe,[t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[u(" Start Date "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>s.formData.start_date=o),type:"date",class:m(["w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-all duration-200",s.errors.start_date?"border-red-500":"border-gray-300 dark:border-gray-600"])},null,2),[[y,s.formData.start_date]]),s.errors.start_date?(d(),l("p",fe,g(s.errors.start_date),1)):c("",!0)]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[u(" End Date "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>s.formData.end_date=o),type:"date",class:m(["w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-all duration-200",s.errors.end_date?"border-red-500":"border-gray-300 dark:border-gray-600"])},null,2),[[y,s.formData.end_date]]),s.errors.end_date?(d(),l("p",xe,g(s.errors.end_date),1)):c("",!0)])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Notes ",-1)),h(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=o=>s.formData.notes=o),rows:"3",class:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500 transition-all duration-200",placeholder:"Additional notes or information"},null,512),[[y,s.formData.notes]])]),t("div",be,[t("button",{type:"button",onClick:e[10]||(e[10]=(...o)=>n.closeModal&&n.closeModal(...o)),class:"px-6 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-all duration-200"}," Cancel "),t("button",{type:"submit",disabled:s.saving,class:"px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white rounded-lg transition-all duration-200 disabled:opacity-50"},[s.saving?(d(),l("div",ve,[...e[30]||(e[30]=[t("div",{class:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},null,-1),u(" Saving... ",-1)])])):(d(),l("span",we,g(s.editingSession?"Update Session":"Create Session"),1))],8,ke)])],32)])])):c("",!0)])}const De=x(T,[["render",_e],["__scopeId","data-v-645e16fb"]]);export{De as default};
