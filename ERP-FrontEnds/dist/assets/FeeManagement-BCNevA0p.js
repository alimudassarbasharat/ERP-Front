import{_ as ye,o as ve,u as be,r as d,W as J,l as Ve,s as o,x as Ce,c as A,b as v,y as e,z as a,d as f,w as we,A as b,D as he,F as L,g as I,E,f as i,t as U,a1 as De,H as Fe,J as Se,C as ke,a3 as Pe,T as xe}from"./index-z4YXot-9.js";const Ue={class:"fee-management-container"},Me={class:"card-header"},Ye={class:"header-actions"},Te={class:"search-section"},ze={class:"pagination-container"},Ae={class:"dialog-footer"},Ee={class:"amount-due"},Ne={class:"dialog-footer"},qe={__name:"FeeManagement",setup(Be){console.log("FeeManagement component is loading"),ve(()=>{console.log("FeeManagement component mounted")});const D=be(),O=d(!1),F=d(""),S=d(""),k=d(""),V=d([]),y=d(1),M=d(10),W=d(0),C=d(!1),w=d(!1),Y=d(null),j=d([{id:1,name:"Class 1"},{id:2,name:"Class 2"},{id:3,name:"Class 3"}]),H=d([{id:"S001",name:"John Doe"},{id:"S002",name:"Jane Smith"},{id:"S003",name:"Mike Johnson"}]),K=d([{id:1,student_id:"S001",student_name:"John Doe",class:"Class 1",fee_type:"tuition",amount:5e4,due_date:"2024-03-15",status:"pending"},{id:2,student_id:"S002",student_name:"Jane Smith",class:"Class 2",fee_type:"registration",amount:1e4,due_date:"2024-03-20",status:"paid"}]),r=J({student_id:"",fee_type:"",amount:0,due_date:"",description:""}),u=J({amount:0,payment_date:"",payment_method:"",transaction_id:"",notes:""}),Q={student_id:[{required:!0,message:"Please select a student",trigger:"change"}],fee_type:[{required:!0,message:"Please select fee type",trigger:"change"}],amount:[{required:!0,message:"Please enter amount",trigger:"blur"}],due_date:[{required:!0,message:"Please select due date",trigger:"change"}]},G={amount:[{required:!0,message:"Please enter payment amount",trigger:"blur"}],payment_date:[{required:!0,message:"Please select payment date",trigger:"change"}],payment_method:[{required:!0,message:"Please select payment method",trigger:"change"}]},X=Ve(()=>{let n=[...K.value];if(F.value){const t=F.value.toLowerCase();n=n.filter(m=>m.student_name.toLowerCase().includes(t)||m.student_id.toLowerCase().includes(t))}if(S.value&&(n=n.filter(t=>t.class===S.value)),k.value&&(n=n.filter(t=>t.status===k.value)),V.value&&V.value.length===2){const[t,m]=V.value;n=n.filter(p=>{const g=new Date(p.due_date);return g>=t&&g<=m})}return n}),N=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PKR"}).format(n),Z=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),ee=n=>{switch(n){case"paid":return"success";case"pending":return"warning";case"overdue":return"danger";default:return"info"}},q=()=>{y.value=1},T=()=>{y.value=1},te=n=>{M.value=n,y.value=1},le=n=>{y.value=n},ae=()=>{C.value=!0},ne=async()=>{console.log("Submitting fee:",r),D.success("Fee added successfully"),C.value=!1},oe=n=>{Y.value=n,u.amount=n.amount,w.value=!0},se=async()=>{console.log("Processing payment:",u),D.success("Payment processed successfully"),w.value=!1},de=n=>{console.log("Viewing details for fee:",n)},ue=n=>{xe.confirm("Are you sure you want to delete this fee record?","Warning",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"}).then(()=>{console.log("Deleting fee:",n),D.success("Fee deleted successfully")}).catch(()=>{})},re=()=>{console.log("Exporting fees"),D.success("Fees exported successfully")};return(n,t)=>{const m=o("el-icon"),p=o("el-button"),g=o("el-input"),P=o("el-col"),s=o("el-option"),h=o("el-select"),z=o("el-date-picker"),ie=o("el-row"),_=o("el-table-column"),me=o("el-tag"),pe=o("el-button-group"),ce=o("el-table"),_e=o("el-pagination"),fe=o("el-card"),c=o("el-form-item"),B=o("el-input-number"),R=o("el-form"),$=o("el-dialog"),ge=Ce("loading");return v(),A("div",Ue,[e(fe,{class:"fee-management-card"},{header:a(()=>[f("div",Me,[t[22]||(t[22]=f("h2",{class:"title"},"Fee Management",-1)),f("div",Ye,[e(p,{type:"primary",onClick:ae},{default:a(()=>[e(m,null,{default:a(()=>[e(b(ke))]),_:1}),t[20]||(t[20]=i(" Add New Fee "))]),_:1,__:[20]}),e(p,{type:"success",onClick:re},{default:a(()=>[e(m,null,{default:a(()=>[e(b(Pe))]),_:1}),t[21]||(t[21]=i(" Export Fees "))]),_:1,__:[21]})])])]),default:a(()=>[f("div",Te,[e(ie,{gutter:20},{default:a(()=>[e(P,{span:6},{default:a(()=>[e(g,{modelValue:F.value,"onUpdate:modelValue":t[0]||(t[0]=l=>F.value=l),placeholder:"Search by student name or ID",clearable:"",onClear:q,onInput:q},{prefix:a(()=>[e(m,null,{default:a(()=>[e(b(he))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(P,{span:6},{default:a(()=>[e(h,{modelValue:S.value,"onUpdate:modelValue":t[1]||(t[1]=l=>S.value=l),placeholder:"Select Class",clearable:"",onChange:T},{default:a(()=>[(v(!0),A(L,null,I(j.value,l=>(v(),E(s,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(P,{span:6},{default:a(()=>[e(h,{modelValue:k.value,"onUpdate:modelValue":t[2]||(t[2]=l=>k.value=l),placeholder:"Payment Status",clearable:"",onChange:T},{default:a(()=>[e(s,{label:"Paid",value:"paid"}),e(s,{label:"Pending",value:"pending"}),e(s,{label:"Overdue",value:"overdue"})]),_:1},8,["modelValue"])]),_:1}),e(P,{span:6},{default:a(()=>[e(z,{modelValue:V.value,"onUpdate:modelValue":t[3]||(t[3]=l=>V.value=l),type:"daterange","range-separator":"to","start-placeholder":"Start date","end-placeholder":"End date",onChange:T},null,8,["modelValue"])]),_:1})]),_:1})]),we((v(),E(ce,{data:X.value,style:{width:"100%"},border:"",stripe:""},{default:a(()=>[e(_,{prop:"student_id",label:"Student ID",width:"120"}),e(_,{prop:"student_name",label:"Student Name","min-width":"180"}),e(_,{prop:"class",label:"Class",width:"120"}),e(_,{prop:"fee_type",label:"Fee Type",width:"150"}),e(_,{prop:"amount",label:"Amount",width:"120"},{default:a(({row:l})=>[i(U(N(l.amount)),1)]),_:1}),e(_,{prop:"due_date",label:"Due Date",width:"120"},{default:a(({row:l})=>[i(U(Z(l.due_date)),1)]),_:1}),e(_,{prop:"status",label:"Status",width:"120"},{default:a(({row:l})=>[e(me,{type:ee(l.status)},{default:a(()=>[i(U(l.status),1)]),_:2},1032,["type"])]),_:1}),e(_,{label:"Actions",width:"200",fixed:"right"},{default:a(({row:l})=>[e(pe,null,{default:a(()=>[e(p,{type:"primary",size:"small",onClick:x=>oe(l),disabled:l.status==="paid"},{default:a(()=>[e(m,null,{default:a(()=>[e(b(De))]),_:1}),t[23]||(t[23]=i(" Pay "))]),_:2,__:[23]},1032,["onClick","disabled"]),e(p,{type:"info",size:"small",onClick:x=>de(l)},{default:a(()=>[e(m,null,{default:a(()=>[e(b(Fe))]),_:1}),t[24]||(t[24]=i(" View "))]),_:2,__:[24]},1032,["onClick"]),e(p,{type:"danger",size:"small",onClick:x=>ue(l)},{default:a(()=>[e(m,null,{default:a(()=>[e(b(Se))]),_:1}),t[25]||(t[25]=i(" Delete "))]),_:2,__:[25]},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ge,O.value]]),f("div",ze,[e(_e,{"current-page":y.value,"onUpdate:currentPage":t[4]||(t[4]=l=>y.value=l),"page-size":M.value,"onUpdate:pageSize":t[5]||(t[5]=l=>M.value=l),"page-sizes":[10,20,50,100],total:W.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:te,onCurrentChange:le},null,8,["current-page","page-size","total"])])]),_:1}),e($,{modelValue:C.value,"onUpdate:modelValue":t[12]||(t[12]=l=>C.value=l),title:"Add New Fee",width:"50%","close-on-click-modal":!1},{footer:a(()=>[f("span",Ae,[e(p,{onClick:t[11]||(t[11]=l=>C.value=!1)},{default:a(()=>t[26]||(t[26]=[i("Cancel")])),_:1,__:[26]}),e(p,{type:"primary",onClick:ne},{default:a(()=>t[27]||(t[27]=[i("Submit")])),_:1,__:[27]})])]),default:a(()=>[e(R,{ref:"feeFormRef",model:r,rules:Q,"label-width":"120px"},{default:a(()=>[e(c,{label:"Student",prop:"student_id"},{default:a(()=>[e(h,{modelValue:r.student_id,"onUpdate:modelValue":t[6]||(t[6]=l=>r.student_id=l),placeholder:"Select Student",filterable:"",style:{width:"100%"}},{default:a(()=>[(v(!0),A(L,null,I(H.value,l=>(v(),E(s,{key:l.id,label:`${l.name} (${l.id})`,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"Fee Type",prop:"fee_type"},{default:a(()=>[e(h,{modelValue:r.fee_type,"onUpdate:modelValue":t[7]||(t[7]=l=>r.fee_type=l),placeholder:"Select Fee Type",style:{width:"100%"}},{default:a(()=>[e(s,{label:"Tuition Fee",value:"tuition"}),e(s,{label:"Registration Fee",value:"registration"}),e(s,{label:"Exam Fee",value:"exam"}),e(s,{label:"Library Fee",value:"library"}),e(s,{label:"Transport Fee",value:"transport"}),e(s,{label:"Other",value:"other"})]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"Amount",prop:"amount"},{default:a(()=>[e(B,{modelValue:r.amount,"onUpdate:modelValue":t[8]||(t[8]=l=>r.amount=l),min:0,precision:2,step:1e3,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(c,{label:"Due Date",prop:"due_date"},{default:a(()=>[e(z,{modelValue:r.due_date,"onUpdate:modelValue":t[9]||(t[9]=l=>r.due_date=l),type:"date",placeholder:"Select due date",style:{width:"100%"},format:"MM/DD/YYYY","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(c,{label:"Description",prop:"description"},{default:a(()=>[e(g,{modelValue:r.description,"onUpdate:modelValue":t[10]||(t[10]=l=>r.description=l),type:"textarea",rows:3,placeholder:"Enter fee description"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e($,{modelValue:w.value,"onUpdate:modelValue":t[19]||(t[19]=l=>w.value=l),title:"Process Payment",width:"40%","close-on-click-modal":!1},{footer:a(()=>[f("span",Ne,[e(p,{onClick:t[18]||(t[18]=l=>w.value=!1)},{default:a(()=>t[28]||(t[28]=[i("Cancel")])),_:1,__:[28]}),e(p,{type:"primary",onClick:se},{default:a(()=>t[29]||(t[29]=[i("Process Payment")])),_:1,__:[29]})])]),default:a(()=>[e(R,{ref:"paymentFormRef",model:u,rules:G,"label-width":"120px"},{default:a(()=>[e(c,{label:"Amount Due"},{default:a(()=>{var l;return[f("span",Ee,U(N((l=Y.value)==null?void 0:l.amount)),1)]}),_:1}),e(c,{label:"Payment Amount",prop:"amount"},{default:a(()=>{var l;return[e(B,{modelValue:u.amount,"onUpdate:modelValue":t[13]||(t[13]=x=>u.amount=x),min:0,max:(l=Y.value)==null?void 0:l.amount,precision:2,step:1e3,style:{width:"100%"}},null,8,["modelValue","max"])]}),_:1}),e(c,{label:"Payment Date",prop:"payment_date"},{default:a(()=>[e(z,{modelValue:u.payment_date,"onUpdate:modelValue":t[14]||(t[14]=l=>u.payment_date=l),type:"date",placeholder:"Select payment date",style:{width:"100%"},format:"MM/DD/YYYY","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(c,{label:"Payment Method",prop:"payment_method"},{default:a(()=>[e(h,{modelValue:u.payment_method,"onUpdate:modelValue":t[15]||(t[15]=l=>u.payment_method=l),placeholder:"Select payment method",style:{width:"100%"}},{default:a(()=>[e(s,{label:"Cash",value:"cash"}),e(s,{label:"Bank Transfer",value:"bank_transfer"}),e(s,{label:"Credit Card",value:"credit_card"}),e(s,{label:"Check",value:"check"})]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"Transaction ID",prop:"transaction_id"},{default:a(()=>[e(g,{modelValue:u.transaction_id,"onUpdate:modelValue":t[16]||(t[16]=l=>u.transaction_id=l),placeholder:"Enter transaction ID"},null,8,["modelValue"])]),_:1}),e(c,{label:"Notes",prop:"notes"},{default:a(()=>[e(g,{modelValue:u.notes,"onUpdate:modelValue":t[17]||(t[17]=l=>u.notes=l),type:"textarea",rows:3,placeholder:"Enter payment notes"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},$e=ye(qe,[["__scopeId","data-v-21b331da"]]);export{$e as default};
